## 3 æµ…å±‚ç¥ç»ç½‘ç»œ(Shallow neural networks)

### 3.1 ç¥ç»ç½‘ç»œçš„è¡¨ç¤º


#### 3.1.1 ç¥ç»ç½‘ç»œçš„ç»“æ„è¡¨ç¤º

ä¸‹å›¾æ‰€ç¤ºä¸ºåªåŒ…å«ä¸€ä¸ªéšè—å±‚çš„ç¥ç»ç½‘ç»œï¼š
<img src="https://upload-images.jianshu.io/upload_images/24435917-a1ba546501676c53.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="zoom:50%;" />

- è¾“å…¥å±‚ï¼šè¾“å…¥ç‰¹å¾$x_1$ã€$x_2$ã€$x_3$ï¼Œ å®ƒä»¬è¢«ç«–ç›´åœ°å †å èµ·æ¥å½¢æˆåˆ—ï¼Œä½œä¸ºç¥ç»ç½‘ç»œçš„è¾“å…¥ã€‚
- éšè—å±‚ï¼šä¸Šå›¾ä¸­é—´çš„å››ä¸ªç¥ç»å…ƒã€‚åœ¨è®­ç»ƒç¥ç»ç½‘ç»œæ—¶ï¼Œæˆ‘ä»¬åªçŸ¥é“ç½‘ç»œçš„è¾“å…¥å€¼å’Œè¾“å‡ºå€¼ï¼Œæ— æ³•å¾—çŸ¥éšè—å±‚ä¸­å„èŠ‚ç‚¹çš„å…·ä½“æ•°å€¼ã€‚
- è¾“å‡ºå±‚ï¼šå¦‚ä¸Šå›¾ä¸­æœ€åä¸€å±‚çš„ä¸€ä¸ªç¥ç»å…ƒï¼Œè´Ÿè´£äº§ç”Ÿé¢„æµ‹å€¼ã€‚

#### 3.1.2 ç¥ç»ç½‘ç»œçš„ç¬¦å·è¡¨ç¤º
![](https://upload-images.jianshu.io/upload_images/24435917-75c9d9f534c1e572.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

æ€»ç»“ï¼š

- **x**è¡¨ç¤ºè¾“å…¥ç‰¹å¾ï¼Œ**a**è¡¨ç¤ºæ¯ä¸ªç¥ç»å…ƒçš„è¾“å‡ºï¼Œ**W**è¡¨ç¤ºç‰¹å¾çš„æƒé‡ã€‚**åœ¨è®¡ç®—ç¥ç»ç½‘ç»œçš„å±‚æ•°æ—¶ï¼Œä¸è®¡ç®—è¾“å…¥å±‚**ï¼Œæ•…éšè—å±‚ç¬¬ä¸€å±‚ä¸º1ï¼Œä»¥æ­¤ç±»æ¨ï¼›è€Œåœ¨ç¬¦å·çº¦å®šä¸­ï¼Œå°†è¾“å…¥å±‚ç§°ä¸ºç¬¬é›¶å±‚ã€‚ä¸Šæ ‡è¡¨ç¤ºæ‰€å¤„ç¥ç»ç½‘ç»œçš„å±‚æ•°ï¼Œä¸‹æ ‡è¡¨ç¤ºè¯¥å±‚çš„ç¬¬å‡ ä¸ªç¥ç»å…ƒã€‚

ç»†èŠ‚ï¼šåœ¨ä¸Šå›¾æ‰€ç¤ºçš„ç¥ç»ç½‘ç»œä¸­

- è¾“å…¥å±‚çš„æ¿€æ´»å€¼ç§°ä¸º$a^{[0]}$ã€‚
- éšè—å±‚æ¿€æ´»å€¼è®°ä½œ$a^{[1]}$ã€‚è¿™ä¸€å±‚ç¬¬ä¸€ä¸ªå•å…ƒï¼ˆèŠ‚ç‚¹ï¼‰è¡¨ç¤ºä¸º$a_{1}^{[1]}$ï¼Œç¬¬äºŒä¸ªç¥ç»å…ƒçš„å€¼ä¸º$a_{2}^{[1]}$ï¼Œä»¥æ­¤ç±»æ¨ã€‚æœ¬ä¾‹ä¸­ï¼Œç¥ç»ç½‘ç»œç¬¬ä¸€å±‚å³éšè—å±‚æœ‰å››ä¸ªèŠ‚ç‚¹ï¼Œåœ¨Pythonä»£ç ä¸­æ˜¯ä¸€ä¸ª4x1çš„çŸ©é˜µï¼š
                                                                                                                 $a^{[1]}=\left[\begin{array}{l}
a_{1}^{[1]} \\
a_{2}^{[1]} \\
a_{3}^{[1]} \\
a_{4}^{[1]}
\end{array}\right]$
-  è¾“å‡ºå±‚å°†äº§ç”ŸæŸä¸ªæ•°å€¼$a^{[2]}$ï¼Œå³ä¸ºè¯¥ç½‘ç»œè¾“å‡ºçš„é¢„æµ‹å€¼$\hat{y}$ã€‚

å‚æ•°ç¬¦å·è¡¨ç¤ºï¼š

- éšè—å±‚æ‹¥æœ‰ä¸¤ä¸ªå‚æ•°**W**å’Œ**b**ï¼Œ$\left(W^{[1]}, b^{[1]}\right)$è¡¨ç¤ºè¯¥å‚æ•°æ˜¯ç¥ç»ç½‘ç»œç¬¬ä¸€å±‚æ‰€ç”¨çš„å‚æ•°ã€‚ä¾‹å¦‚ï¼šåœ¨è¿™ä¸ªä¾‹å­ä¸­**W**æ˜¯ä¸€ä¸ª4x3çš„çŸ©é˜µï¼Œ**b**æ˜¯ä¸€ä¸ª4x1çš„å‘é‡ã€‚4æºäºéšè—å±‚å«æœ‰å››ä¸ªç¥ç»å…ƒï¼Œ3æºäºæ¯ä¸ªç¥ç»å…ƒéƒ½æœ‰ä¸‰ä¸ªè¾“å…¥ç‰¹å¾ã€‚
- ç±»ä¼¼åœ°ï¼Œè¾“å‡ºå±‚ä¹Ÿæœ‰ä¸€äº›ä¸ä¹‹å…³è”çš„å‚æ•°$W^{[2]}$ã€$b^{[2]}$ã€‚å®ƒä»¬çš„è§„æ¨¡åˆ†åˆ«æ˜¯1x4ä»¥åŠ1x1ã€‚1x4æ˜¯å› ä¸ºéšè—å±‚æœ‰å››ä¸ªç¥ç»å…ƒè€Œè¾“å‡ºå±‚åªæœ‰ä¸€ä¸ªã€‚

### 3.2 è®¡ç®—å•æ ·æœ¬çš„ç¥ç»ç½‘ç»œè¾“å‡º
æœ¬èŠ‚å°†ä»‹ç»ç¥ç»ç½‘ç»œæ˜¯å¦‚ä½•è¿è¡Œçš„ï¼Œå³ç¥ç»ç½‘ç»œæ˜¯æ€ä¹ˆè¾“å…¥$x$ï¼Œåˆæ˜¯æ€ä¹ˆå¾—åˆ°$\hat{y}$ã€‚
#### 3.2.1 å•ä¸ªç¥ç»å…ƒçš„è®¡ç®—
![](https://upload-images.jianshu.io/upload_images/24435917-71a34a47fd490b26.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

æ¯ä¸ªç¥ç»å…ƒçš„è®¡ç®—åˆ†ä¸ºä¸¤æ­¥ï¼šé¦–å…ˆè®¡ç®—å‡º$z$ï¼Œå†è®¡ç®—å‡º$a$ã€‚ä»¥éšè—å±‚ç¬¬ä¸€ä¸ªç¥ç»å…ƒä¸ºä¾‹ï¼š
ç¬¬ä¸€æ­¥ï¼Œè®¡ç®—$z_{1}^{[1]}ï¼šz_{1}^{[1]}=w_{1}^{[1] T} x+b_{1}^{[1]}$ã€‚
ç¬¬äºŒæ­¥ï¼Œä»¥sigmoidå‡½æ•°ä¸ºæ¿€æ´»å‡½æ•°è®¡ç®—$z_{1}^{[1]}$å¾—åˆ°$a_{1}^{[1]}$ï¼š$a_{1}^{[1]}=\sigma\left(z_{1}^{[1]}\right)$ã€‚
éšè—å±‚åé¢ç¥ç»å…ƒçš„è®¡ç®—è¿‡ç¨‹ä¸€æ ·ï¼Œåªæ˜¯æ³¨æ„ç¬¦å·è¡¨ç¤ºçš„ä¸åŒï¼Œåˆ†åˆ«å¾—åˆ°$a_{2}^{[1]}, a_{3}^{[1]}, a_{4}^{[1]}$ï¼Œè¯¦ç»†ç»“æœè§ä¸‹:
                                                  $$\begin{array}{l}
z_{1}^{[1]}=w_{1}^{[1] T} x+b_{1}^{[1]}, a_{1}^{[1]}=\sigma\left(z_{1}^{[1]}\right) \\
z_{2}^{[1]}=w_{2}^{[1] T} x+b_{2}^{[1]}, a_{2}^{[1]}=\sigma\left(z_{2}^{[1]}\right) \\
z_{3}^{[1]}=w_{3}^{[1] T} x+b_{3}^{[1]}, a_{3}^{[1]}=\sigma\left(z_{3}^{[1]}\right) \\
z_{4}^{[1]}=w_{4}^{[1] T} x+b_{4}^{[1]}, a_{4}^{[1]}=\sigma\left(z_{4}^{[1]}\right)
\end{array}$$

#### 3.2.2 å‘é‡åŒ–è®¡ç®—
åœ¨pythonä¸­ä½¿ç”¨çŸ©é˜µæ¥æ‰§è¡Œè®¡ç®—ç¨‹åºï¼Œå³å‘é‡åŒ–è®¡ç®—ã€‚ä½¿ç”¨å‘é‡åŒ–çš„æ–¹æ³•ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡çŸ©é˜µè¿ç®—ï¼Œä¸éœ€è¦ä½¿ç”¨forå¾ªç¯ï¼Œæ›´åŠ å¿«é€Ÿé«˜æ•ˆã€‚

å‘é‡åŒ–çš„è¿‡ç¨‹æ˜¯å°†ç¥ç»ç½‘ç»œä¸­çš„ä¸€å±‚ç¥ç»å…ƒå‚æ•°çºµå‘å †ç§¯èµ·æ¥ï¼Œä¾‹å¦‚éšè—å±‚ä¸­çš„$W$çºµå‘å †ç§¯èµ·æ¥å˜æˆä¸€ä¸ª(4,3)çš„çŸ©é˜µï¼Œç”¨ç¬¦å·$W^{[1]}$è¡¨ç¤ºã€‚ï¼ˆ4ä¸ªé€»è¾‘å›å½’å•å…ƒï¼Œæ¯ä¸€ä¸ªé€»è¾‘å›å½’å•å…ƒéƒ½æœ‰3ä¸ªç›¸å¯¹åº”çš„å‚æ•°ï¼‰

å› æ­¤ï¼Œ å¾—åˆ°å…¬å¼
                                                                    $$z^{[n]}=W^{[n]} x+b^{[n]}$$

â€‹                                                                    $$a^{[n]}=\sigma\left(z^{[n]}\right)$$

å…·ä½“å±•å¼€è®¡ç®—å¼å¯ä»¥ç†è§£ä¸ºï¼š

â€‹                                                               $$a^{[1]}=\left[\begin{array}{l}
a_{1}^{[1]} \\
a_{2}^{[1]} \\
a_{3}^{[1]} \\
a_{4}^{[1]}
\end{array}\right]=\sigma\left(z^{[1]}\right)$$

â€‹                                   $$z^{[1]}=\left[\begin{array}{c}
z_{1}^{[1]} \\
z_{2}^{[1]} \\
z_{3}^{[1]} \\
z_{4}^{[1]}
\end{array}\right]=\left[\begin{array}{c}
\left.\ldots W_{1}^{[1] T} \ldots\right ]\\
\cdots W_{2}^{[1] T} \cdots \\
\cdots W_{3}^{[1] T} \cdots \\
\ldots W_{4}^{[1] T} \cdots
\end{array}\right] *\left[\begin{array}{c}
x_{1} \\
x_{2} \\
x_{3}
\end{array}\right]+\left[\begin{array}{c}
b_{1}^{[1]} \\
b_{2}^{[1]} \\
b_{3}^{[1]} \\
b_{4}^{[1]}
\end{array}\right]$$

ç±»ä¼¼çš„ï¼Œä¸‹ä¸€å±‚ç½‘ç»œçš„è¡¨ç¤ºå¯ä»¥å†™æˆç±»ä¼¼çš„å½¢å¼ï¼Œå¾—åˆ°$a^{[2]}, \hat{y}=a^{[2]}$ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š
![](https://upload-images.jianshu.io/upload_images/24435917-c45b3b511e99de5c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

### 3.3 å¤šæ ·æœ¬å‘é‡åŒ–çš„ç¥ç»ç½‘ç»œè¾“å‡º
3.2èŠ‚ä¸­ä»…é’ˆå¯¹äºå•ä¸€çš„è®­ç»ƒæ ·æœ¬è§£é‡Šå‘é‡åŒ–è®¡ç®—ã€‚æœ¬èŠ‚ä»‹ç»å¤šæ ·æœ¬çš„å‘é‡åŒ–è®¡ç®—ï¼Œå³é‡å¤mæ¬¡å•æ ·æœ¬è®¡ç®—è¿‡ç¨‹ã€‚

#### 3.3.1 å‘é‡åŒ–çš„è¿ç®—ç¬¦å·å®šä¹‰

- å…ˆåˆ©ç”¨ç¬¬ä¸€ä¸ªè®­ç»ƒæ ·æœ¬$x^{(1)}$è®¡ç®—å‡ºé¢„æµ‹å€¼$\hat{y}^{(1)}$ï¼›
- ç”¨ç¬¬äºŒä¸ªæ ·æœ¬$x^{(2)}$æ¥è®¡ç®—å‡ºé¢„æµ‹å€¼$\hat{y}^{(2)}$ã€‚
- ä»¥æ­¤ç±»æ¨ï¼Œç›´åˆ°æœ€åç¬¬mä¸ªæ ·æœ¬ï¼Œç”¨$x^{(m)}$è®¡ç®—å‡º$\hat{y}^{(m)}$ã€‚

è¡¨ç¤ºæ–¹æ³•ï¼šä»¥æ¿€æ´»å‡½æ•°è¡¨ç¤ºæ³•ä¸ºä¾‹ï¼Œ$\alpha^{[2]}=\hat{y}$ï¼Œå®ƒå†™æˆ$a^{[2](1)}$, $a^{[2](2)}$, ..., $a^{[2](m)}$ã€‚

ã€æ³¨ã€‘ï¼š$a^{[2](i)}$ï¼Œ(i)æ˜¯æŒ‡ç¬¬iä¸ªè®­ç»ƒæ ·æœ¬ï¼Œ[2]æ˜¯æŒ‡å±‚æ•°ä¸ºç¬¬äºŒå±‚ã€‚

ä¸Šè¿°å…¬å¼å¯ä»¥æ•´ç†ä¸ºï¼š
$$
z^{[1](i)}=W^{[1](i)} x^{(i)}+b^{[1](i)} \\
a^{[1](i)}=\sigma\left(z^{[1](i)}\right) \\
z^{[2](i)}=W^{[2](i)} a^{[1](i)}+b^{[2](i)} \\
a^{[2](i)}=\sigma\left(z^{[2](i)}\right)
$$
å¯ä»¥çœ‹å‡º(i)ï¼ˆi=1,2...mï¼‰æ˜¯æ‰€æœ‰ä¾èµ–äºè®­ç»ƒæ ·æœ¬çš„å˜é‡ã€‚å¦‚æœæƒ³è®¡ç®—mä¸ªè®­ç»ƒæ ·æœ¬ä¸Šçš„æ‰€æœ‰è¾“å‡ºï¼Œå°±åº”è¯¥å‘é‡åŒ–æ•´ä¸ªè®¡ç®—ä»¥ç®€åŒ–ã€‚

#### 3.3.2 å¤šæ ·æœ¬å‘é‡åŒ–è®¡ç®—

å®šä¹‰çŸ©é˜µ$X$å«æœ‰mä¸ªè®­ç»ƒæ ·æœ¬ï¼Œåˆ™**æ¯ä¸€åˆ—ä»£è¡¨ä¸€ä¸ªæ ·æœ¬**ï¼Œå½¢æˆä¸€ä¸ªnÃ—mçš„çŸ©é˜µï¼Œå³ï¼š

$$x=\left[\begin{array}{cccc}
\vdots & \vdots & \vdots & \vdots \\
x^{(1)} & x^{(2)} & \cdots & x^{(m)} \\
\vdots & \vdots & \vdots & \vdots
\end{array}\right]$$

åŒç†ï¼Œå®šä¹‰çŸ©é˜µ$Z^{[1]}$çš„å„åˆ—åˆ†åˆ«ä¸º$z^{[1](1)}$, $z^{[1](2)}$, ..., $z^{[1](m)}$çš„åˆ—å‘é‡ï¼Œå³ï¼š

$$Z^{[1]}=\left[\begin{array}{cccc}
\vdots & \vdots & \vdots & \vdots \\
z^{[1](1)} & z^{[1](2)} & \cdots & z^{[1](m)} \\
\vdots & \vdots & \vdots & \vdots
\end{array}\right]$$

é€šè¿‡è¿™ç§å®šä¹‰æ–¹æ³•ï¼Œå¯ä»¥æ–¹ä¾¿åœ°åˆ©ç”¨çŸ©é˜µå¯¹æ ·æœ¬æ•°æ®è¿›è¡Œç´¢å¼•ã€‚

- **ä»æ°´å¹³ä¸Šçœ‹ï¼ŒçŸ©é˜µä»£è¡¨äº†å„ä¸ªè®­ç»ƒæ ·æœ¬ã€‚ä»ç«–ç›´ä¸Šçœ‹ï¼ŒçŸ©é˜µçš„ä¸åŒç´¢å¼•å¯¹åº”äºä¸åŒçš„éšè—å•å…ƒ**ã€‚
- **å•çœ‹çŸ©é˜µä¸­æŸä¸€è¡Œï¼Œè¯¥è¡Œä»£è¡¨æœ¬å±‚æŸä¸€ä¸ªç¥ç»å•å…ƒï¼Œæ°´å¹³ï¼ˆåˆ—ï¼‰ç´¢å¼•åˆ†åˆ«å¯¹åº”ç¬¬1ä¸ªè®­ç»ƒæ ·æœ¬ï¼Œç¬¬2ä¸ªè®­ç»ƒæ ·æœ¬â€¦â€¦ç›´åˆ°æœ€ç»ˆç¬¬mä¸ªè®­ç»ƒæ ·æœ¬çš„æ¿€æ´»å€¼ã€‚**
- **å•çœ‹çŸ©é˜µä¸­æŸä¸€åˆ—ï¼Œè¯¥åˆ—ä»£è¡¨ä¸€ä¸ªè®­ç»ƒæ ·æœ¬ï¼Œå‚ç›´ï¼ˆè¡Œï¼‰ç´¢å¼•å¯¹åº”äºæœ¬å±‚ç¥ç»ç½‘ç»œä¸­çš„ä¸åŒç¥ç»å…ƒã€‚**

å‘é‡åŒ–å®ç°çš„è§£é‡Šï¼ˆJustification for vectorized implementationï¼‰

**ä¸ºä»€ä¹ˆå‰é¢æ•´ç†çš„å…¬å¼å°±æ˜¯å°†å¤šä¸ªæ ·æœ¬å‘é‡åŒ–çš„æ­£ç¡®å®ç°ï¼Ÿ**

è¿ç”¨çº¿æ€§ä»£æ•°çš„çŸ¥è¯†ï¼Œä»¥ä¸‰ä¸ªè®­ç»ƒæ ·æœ¬ä¸ºä¾‹ï¼Œæ‰‹åŠ¨è®¡ç®—å‰å‘ä¼ æ’­çš„è¿‡ç¨‹ï¼Œå¾—åˆ°å¦‚ä¸‹è§„å¾‹ï¼š
$$
z^{[1](1)}=W^{[1]} x^{(1)}+b^{[1]} \\
z^{[1](2)}=W^{[1]} x^{(2)}+b^{[1]} \\
z^{[1](3)}=W^{[1]} x^{(3)}+b^{[1]}
$$
åˆ©ç”¨Python çš„å¹¿æ’­æœºåˆ¶ï¼Œå¯ä»¥å¾ˆå®¹æ˜“çš„å°†åŒç­‰ç»´åº¦çš„$b^{[1]}$åŠ è¿›æ¥ï¼Œæ‰€ä»¥ä¸ºäº†æè¿°æ–¹ä¾¿ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆå¿½ç•¥å…¬å¼ä¸­çš„$b^{[1]}$ã€‚

ç°åœ¨$W^{[1]}$æ˜¯ä¸€ä¸ªçŸ©é˜µï¼Œ$x^{(1)}$,$x^{(2)}$,$x^{(3)}$éƒ½æ˜¯åˆ—å‘é‡ï¼ŒçŸ©é˜µä¹˜ä»¥åˆ—å‘é‡å¾—åˆ°åˆ—å‘é‡ï¼Œç”¨å›¾å½¢ç›´è§‚çš„è¡¨ç¤ºå¦‚ä¸‹: 
![](https://upload-images.jianshu.io/upload_images/24435917-46b314558f67cddc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

ç”¨ä¸åŒçš„é¢œè‰²è¡¨ç¤ºä¸Šå›¾ä¸­ä¸åŒçš„æ ·æœ¬å‘é‡åŠå…¶å¯¹åº”çš„è¾“å‡ºå¯å¾—åˆ°ä¸‹å›¾ï¼Œæ›´åŠ ç›´è§‚åœ°çœ‹å‡ºï¼Œå½“åŠ å…¥æ›´å¤šæ ·æœ¬æ—¶ï¼Œ**ä»…ç›¸å½“äºå‘çŸ©é˜µ$X$ä¸­åŠ å…¥æ›´å¤šåˆ—**ã€‚

![](https://upload-images.jianshu.io/upload_images/24435917-fbebc806ef5a084c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

è€ŒPythonçš„å¹¿æ’­æœºåˆ¶å¯¹äºè¿™ç§çŸ©é˜µä¸å‘é‡ç›´æ¥ç›¸åŠ çš„å¤„ç†æ–¹å¼æ˜¯ï¼Œå°†å‘é‡ä¸çŸ©é˜µçš„æ¯ä¸€åˆ—ç›¸åŠ ã€‚æ•…çŸ©é˜µ$W^{[1]} X$ä¸å‘é‡$b^{[1]}$ç›¸åŠ å¾—åˆ°çš„å°±æ˜¯$Z^{[1]}$ã€‚

ç”±æ­¤è¯´æ˜äº†ä¸ºä»€ä¹ˆå…¬å¼$Z^{[1]}=W^{[1]} X+b^{[1]}$æ˜¯å‰å‘ä¼ æ’­çš„ç¬¬ä¸€æ­¥è®¡ç®—çš„æ­£ç¡®å‘é‡åŒ–å®ç°ã€‚

ä½¿ç”¨å‘é‡åŒ–çš„æ–¹æ³•ï¼Œå¯ä»¥ä¸éœ€è¦forå¾ªç¯ï¼Œè€Œç›´æ¥é€šè¿‡çŸ©é˜µè¿ç®—å°±å¯ç”±$X$ç›´æ¥è®¡ç®—å‡º$A^{[1]}$ï¼ŒXä¹Ÿå¯ä»¥è®°ä¸º$A^{[0]}$ï¼Œä½¿ç”¨åŒæ ·çš„æ–¹æ³•å°±å¯ä»¥ç”±ç¥ç»ç½‘ç»œä¸­çš„æ¯ä¸€å±‚çš„è¾“å…¥$A^{[i-1]}$ è®¡ç®—è¾“å‡º$A^{[i]}$ã€‚

### 3.4 æ¿€æ´»å‡½æ•°

pytorchåœ¨torch.nn.functionalä¸­å®ç°äº†å¤§éƒ¨åˆ†æ¿€æ´»å‡½æ•°ã€‚

#### 3.4.1 å‡ ç§å¸¸ç”¨çš„æ¿€æ´»å‡½æ•°

**1. sigmoid:** 
 $$ a=\sigma(z)=\frac{1}{1+e^{-z}} $$
![](https://upload-images.jianshu.io/upload_images/24408091-b46793f797ed2c38.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

äºŒåˆ†ç±»é—®é¢˜ä¸­ï¼Œç”±äº**è¾“å‡ºå±‚**${y}$çš„å€¼ä¸º0æˆ–1ï¼Œä¸ºäº†è®©$\hat{y}$çš„æ•°å€¼ä»‹äº0å’Œ1ä¹‹é—´ï¼Œéœ€ä½¿ç”¨sigmoidæ¿€æ´»å‡½æ•°ã€‚

pytorchå®ç°ï¼š

```python
def sigmoid(input):
    r"""sigmoid(input) -> Tensor

    Applies the element-wise function :math:`\text{Sigmoid}(x) = \frac{1}{1 + \exp(-x)}`

    See :class:`~torch.nn.Sigmoid` for more details.
    """
    warnings.warn("nn.functional.sigmoid is deprecated. Use torch.sigmoid instead.")
    return input.sigmoid()
```

**ä¼˜ç‚¹ï¼š**

- Sigmoid å‡½æ•°çš„è¾“å‡ºæ˜ å°„åœ¨(0,1)ä¹‹é—´ï¼Œå•è°ƒè¿ç»­ï¼Œè¾“å‡ºèŒƒå›´æœ‰é™ï¼Œä¼˜åŒ–ç¨³å®šï¼Œå¯ä»¥ç”¨ä½œè¾“å‡ºå±‚ã€‚
- å®ƒåœ¨ç‰©ç†æ„ä¹‰ä¸Šæœ€ä¸ºæ¥è¿‘ç”Ÿç‰©ç¥ç»å…ƒã€‚æ±‚å¯¼å®¹æ˜“ã€‚

**ç¼ºç‚¹ï¼š**

- ç”±äºå…¶è½¯é¥±å’Œæ€§ï¼Œå®¹æ˜“äº§ç”Ÿæ¢¯åº¦æ¶ˆå¤±ï¼Œå¯¼è‡´è®­ç»ƒå‡ºç°é—®é¢˜ã€‚
- å…¶è¾“å‡ºå¹¶ä¸æ˜¯ä»¥0ä¸ºä¸­å¿ƒçš„ã€‚
- è®¡ç®—é‡å¤§ï¼Œæ”¶æ•›ç¼“æ…¢ã€‚

**2. tanh:**
$$a=tanh(z)=\frac{e^{z}-e^{-z}}{e^{z}+e^{-z}}$$
![](https://upload-images.jianshu.io/upload_images/24408091-af9bc1dc953720ef.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
æ•ˆæœæ€»æ˜¯ä¼˜äºsigmoidå‡½æ•°ï¼Œå› ä¸ºå…¶å‡½æ•°å€¼åŸŸåœ¨-1å’Œ1ä¹‹é—´ï¼Œå‡å€¼æ¥è¿‘é›¶ï¼Œä¸­å¿ƒåŒ–æ•°æ®ï¼Œä½¿ä¸‹ä¸€å±‚å­¦ä¹ æ›´ç®€å•ã€‚

>sigmoidå‡½æ•°å’Œtanhå‡½æ•°çš„å…±åŒç¼ºç‚¹ï¼šåœ¨zå¾ˆå¤§æˆ–å¾ˆå°çš„æƒ…å†µä¸‹ï¼Œå¯¼æ•°çš„æ¢¯åº¦å˜å¾—å¾ˆå°ï¼Œæœ€åæ¥è¿‘äº0ï¼Œå¯¼è‡´æ¢¯åº¦ä¸‹é™é€Ÿåº¦é™ä½ã€‚

pytorchå®ç°ï¼š

```python
def tanh(input):
    r"""tanh(input) -> Tensor

    Applies element-wise,
    :math:`\text{Tanh}(x) = \tanh(x) = \frac{\exp(x) - \exp(-x)}{\exp(x) + \exp(-x)}`

    See :class:`~torch.nn.Tanh` for more details.
    """
    warnings.warn("nn.functional.tanh is deprecated. Use torch.tanh instead.")
    return input.tanh()
```

**ä¼˜ç‚¹ï¼š**

- æ¯”Sigmoidå‡½æ•°æ”¶æ•›é€Ÿåº¦æ›´å¿«ã€‚
- ç›¸æ¯”Sigmoidå‡½æ•°ï¼Œå…¶è¾“å‡ºä»¥0ä¸ºä¸­å¿ƒã€‚

**ç¼ºç‚¹ï¼š**

- è¿˜æ˜¯æ²¡æœ‰æ”¹å˜Sigmoidå‡½æ•°çš„æœ€å¤§é—®é¢˜â€”â€”ç”±äºé¥±å’Œæ€§äº§ç”Ÿçš„æ¢¯åº¦æ¶ˆå¤±ã€‚

**3. ä¿®æ­£çº¿æ€§å•å…ƒ(ReLU):**
$$a=\max (0, z)$$
![](https://upload-images.jianshu.io/upload_images/24408091-3526749425eb736f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

ReLUçš„ä¸€ä¸ªç¼ºç‚¹æ˜¯å­¦ä¹ ç‡è¿‡é«˜æ—¶ç¥ç»å…ƒå¯èƒ½ä¼šåæ­»ï¼ˆDying ReLUï¼‰ï¼ŒåŸç†å¯å‚è€ƒï¼šhttps://blog.csdn.net/weixin_42033436/article/details/105331510ï¼Œå¯ä»¥é€šè¿‡é€‰æ‹©è¾ƒå°çš„å­¦ä¹ ç‡æˆ–æ¢ç”¨leaky ReLUã€ELUã€PReLUç­‰æ¿€æ´»å‡½æ•°ä»¥æ”¹è¿›ã€‚<font color=red>è¿™é‡Œçš„å‚è€ƒæ–‡çŒ®æ¢ä¸€ä¸ªå§ï¼Œè¿™ä¸ªçœ‹çš„å¤ªéš¾å—äº†</font>

ä½†åœ¨å®é™…ä¸­ï¼Œè™½ç„¶åœ¨zä¸ºè´Ÿå€¼æ—¶ReLUçš„æ¢¯åº¦ä¸€åŠä¸º0ï¼Œä½†æœ‰è¶³å¤Ÿå¤šçš„éšè—å•å…ƒä½¿zå€¼å¤§äº0ï¼Œæ•…å¯¹å¤§å¤šæ•°è®­ç»ƒæ•°æ®æ¥è¯´å­¦ä¹ è¿‡ç¨‹ä»ç„¶å¾ˆå¿«ã€‚

pytorchå®ç°ï¼š

```python
def relu(input, inplace=False):
    if inplace:
        return torch.relu_(input)
    return torch.relu(input) 
```

**ä¼˜ç‚¹ï¼š**

- ç›¸æ¯”èµ·Sigmoidå’Œtanhï¼ŒReLUåœ¨SGDä¸­èƒ½å¤Ÿå¿«é€Ÿæ”¶æ•›ã€‚æ®ç§°ï¼Œè¿™æ˜¯å› ä¸ºå®ƒçº¿æ€§ã€éé¥±å’Œçš„å½¢å¼ã€‚
- Sigmoidå’Œtanhæ¶‰åŠäº†å¾ˆå¤šå¾ˆexpensiveçš„æ“ä½œï¼ˆæ¯”å¦‚æŒ‡æ•°ï¼‰ï¼ŒReLUå¯ä»¥æ›´åŠ ç®€å•çš„å®ç°ã€‚
- æœ‰æ•ˆç¼“è§£äº†æ¢¯åº¦æ¶ˆå¤±çš„é—®é¢˜ã€‚
- åœ¨æ²¡æœ‰æ— ç›‘ç£é¢„è®­ç»ƒçš„æ—¶å€™ä¹Ÿèƒ½æœ‰è¾ƒå¥½çš„è¡¨ç°ã€‚
- æä¾›äº†ç¥ç»ç½‘ç»œçš„ç¨€ç–è¡¨è¾¾èƒ½åŠ›ã€‚

**ç¼ºç‚¹ï¼š**

- éšç€è®­ç»ƒçš„è¿›è¡Œï¼Œå¯èƒ½ä¼šå‡ºç°ç¥ç»å…ƒæ­»äº¡ï¼Œæƒé‡æ— æ³•æ›´æ–°çš„æƒ…å†µã€‚
- å¦‚æœå‘ç”Ÿè¿™ç§æƒ…å†µï¼Œé‚£ä¹ˆæµç»ç¥ç»å…ƒçš„æ¢¯åº¦ä»è¿™ä¸€ç‚¹å¼€å§‹å°†æ°¸è¿œæ˜¯0ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒReLUç¥ç»å…ƒåœ¨è®­ç»ƒä¸­ä¸å¯é€†åœ°æ­»äº¡äº†ã€‚

**4. leaky ReLU:**
$$a=\max (0.01 z, z)$$
![](https://upload-images.jianshu.io/upload_images/24408091-51c3d9fbc27ccbb8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

Leaky ReLUæœ‰ä¸¤ä¸ªå¥½å¤„ï¼š

- å®ƒæ²¡æœ‰é›¶æ–œç‡éƒ¨åˆ†ï¼Œå› æ­¤å¯ä»¥è§£å†³â€œDying ReLUâ€é—®é¢˜ã€‚
- å®ƒåŠ å¿«äº†è®­ç»ƒé€Ÿåº¦ã€‚æœ‰è¯æ®è¡¨æ˜ï¼Œâ€œå¹³å‡æ¿€æ´»â€æ¥è¿‘0å¯ä½¿è®­ç»ƒæ›´å¿«ã€‚ä¸ReLUä¸åŒï¼ŒLeaky ReLUæ›´â€œå¹³è¡¡â€ï¼Œå› æ­¤å­¦ä¹ èµ·æ¥å¯èƒ½æ›´å¿«ã€‚

Leaky ReLUé€šå¸¸æ¯”ReLUæ¿€æ´»å‡½æ•°æ•ˆæœå¥½ï¼Œä½†å®é™…ä½¿ç”¨ä¸å¤šã€‚

> ReLUå’Œleaky ReLUçš„å…±åŒä¼˜ç‚¹ï¼š1. åœ¨zåŒºé—´å˜åŠ¨å¾ˆå¤§çš„æƒ…å†µä¸‹ï¼Œå…¶å¯¼æ•°éƒ½ä¼šè¿œå¤§äº0ã€‚ä½¿ç”¨ReLUæ¿€æ´»å‡½æ•°ç¥ç»ç½‘ç»œé€šå¸¸æ¯”sigmoidæˆ–tanhæ¿€æ´»å‡½æ•°å­¦ä¹ çš„å¿«ã€‚2.sigmoidå’Œtanhå‡½æ•°çš„å¯¼æ•°åœ¨æ­£è´Ÿé¥±å’ŒåŒºæ¢¯åº¦éƒ½æ¥è¿‘äº0ï¼Œé€ æˆæ¢¯åº¦å¼¥æ•£ï¼Œè€ŒReLUå’Œleaky ReLUå‡½æ•°å¤§äº0éƒ¨åˆ†å¯¼æ•°éƒ½ä¸ºå¸¸æ•°ï¼Œä¸ä¼šäº§ç”Ÿæ¢¯åº¦å¼¥æ•£ç°è±¡ã€‚

pytorchå®ç°ï¼š

```python
def leaky_relu(input, negative_slope=0.01, inplace=False):
    r"""
    leaky_relu(input, negative_slope=0.01, inplace=False) -> Tensor

    Applies element-wise,
    :math:`\text{LeakyReLU}(x) = \max(0, x) + \text{negative\_slope} * \min(0, x)`

    See :class:`~torch.nn.LeakyReLU` for more details.
    """
    if inplace:
        return torch._C._nn.leaky_relu_(input, negative_slope)
    return torch._C._nn.leaky_relu(input, negative_slope)
```

**æ€»ç»“**
**sigmoid** æ¿€æ´»å‡½æ•°ï¼šä¸€èˆ¬åªç”¨äºäºŒåˆ†ç±»é—®é¢˜çš„è¾“å‡ºå±‚ã€‚
**tanh** æ¿€æ´»å‡½æ•°ï¼šå‡ ä¹åœ¨æ‰€æœ‰åœºåˆä¸­éƒ½æ¯”sigmodå‡½æ•°æ›´ä¼˜è¶Šã€‚
**ReLU** æ¿€æ´»å‡½æ•°ï¼šæœ€å¸¸ç”¨çš„ã€é»˜è®¤çš„æ¿€æ´»å‡½æ•°ï¼Œè‹¥ä¸ç¡®å®šä½¿ç”¨å“ªä¸ªå‡½æ•°ï¼Œå°±ä½¿ç”¨**ReLU** æˆ–è€… **leaky ReLU**ã€‚

#### 3.4.2 å…¶ä»–æ¿€æ´»å‡½æ•°

**1. softmaxå‡½æ•°ï¼š**

$$\sigma(z)_{j}=\frac{e^{Z_{j}}}{\sum_{k=1}^{K} e^{Z_{k}}}$$

Sigmoidå‡½æ•°å®é™…ä¸Šå°±æ˜¯æŠŠæ•°æ®æ˜ å°„åˆ°ä¸€ä¸ª(0,1)çš„ç©ºé—´ä¸Šï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒSigmoidå‡½æ•°å¦‚æœç”¨æ¥åˆ†ç±»çš„è¯ï¼Œåªèƒ½è¿›è¡ŒäºŒåˆ†ç±»ï¼Œè€Œè¿™é‡Œçš„softmaxå‡½æ•°å¯ä»¥çœ‹åšæ˜¯Sigmoidå‡½æ•°çš„ä¸€èˆ¬åŒ–ï¼Œå¯ä»¥è¿›è¡Œå¤šåˆ†ç±»ã€‚

**2. softpluså‡½æ•°**

$a=log(1+e^z)$

softpluså‡½æ•°å’ŒReLUå‡½æ•°çš„æ›²çº¿å¦‚ä¸‹ï¼š

![](https://upload-images.jianshu.io/upload_images/24408463-e2ee79abcd90f2e0.png?imageMogr2/auto-orient/strip|imageView2/2/format/webp)

å¯ä»¥çœ‹åˆ°ï¼Œsoftpluså¯ä»¥çœ‹ä½œæ˜¯ReLuçš„å¹³æ»‘ã€‚æ ¹æ®ç¥ç»ç§‘å­¦å®¶çš„ç›¸å…³ç ”ç©¶ï¼Œsoftpluså’ŒReLuä¸è„‘ç¥ç»å…ƒæ¿€æ´»é¢‘ç‡å‡½æ•°æœ‰ç¥ä¼¼çš„åœ°æ–¹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç›¸æ¯”äºæ—©æœŸçš„æ¿€æ´»å‡½æ•°ï¼Œsoftpluså’ŒReLuæ›´åŠ æ¥è¿‘è„‘ç¥ç»å…ƒçš„æ¿€æ´»æ¨¡å‹ï¼Œè€Œç¥ç»ç½‘ç»œæ­£æ˜¯åŸºäºè„‘ç¥ç»ç§‘å­¦å‘å±•è€Œæ¥ï¼Œè¿™ä¸¤ä¸ªæ¿€æ´»å‡½æ•°çš„åº”ç”¨ä¿ƒæˆäº†ç¥ç»ç½‘ç»œç ”ç©¶çš„æ–°æµªæ½®ã€‚

**3. PReLUå‡½æ•°**ï¼ˆå‚æ•°åŒ–ä¿®æ­£çº¿æ€§å•å…ƒï¼‰

$$a=\max (\alpha z, z)$$

![](https://img-blog.csdnimg.cn/202004051921270.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MjAzMzQzNg==,size_16,color_FFFFFF,t_70)

PReLUå‡½æ•°ä¹Ÿæ˜¯é’ˆå¯¹ReLUçš„ä¸€ä¸ªæ”¹è¿›å‹ï¼Œåœ¨è´Ÿæ•°åŒºåŸŸå†…ï¼ŒPReLUæœ‰ä¸€ä¸ªå¾ˆå°çš„æ–œç‡ï¼Œè¿™æ ·ä¹Ÿå¯ä»¥é¿å…ReLUæ­»æ‰çš„é—®é¢˜ã€‚ç›¸æ¯”äºELUï¼ŒPReLUåœ¨è´Ÿæ•°åŒºåŸŸå†…æ˜¯çº¿æ€§è¿ç®—ï¼Œæ–œç‡è™½ç„¶å°ï¼Œä½†æ˜¯ä¸ä¼šè¶‹äº0ï¼Œè¿™ç®—æ˜¯ä¸€å®šçš„ä¼˜åŠ¿å§ã€‚

PReLUçš„å…¬å¼é‡Œé¢çš„å‚æ•°Î±æ˜¯æ ¹æ®æ•°æ®æ¥å®šçš„ï¼Œä¸€èˆ¬æ˜¯å–0~1ä¹‹é—´çš„æ•°ï¼Œè€Œä¸”ä¸€èˆ¬è¿˜æ˜¯æ¯”è¾ƒå°çš„ï¼Œå¦‚é›¶ç‚¹é›¶å‡ ã€‚å½“Î±=0.01æ—¶ï¼ŒPReLUå°±æˆä¸ºLeaky ReLUã€‚

pytorchå®ç°ï¼š

```python
def prelu(input, weight):
    r"""prelu(input, weight) -> Tensor

    Applies element-wise the function
    :math:`\text{PReLU}(x) = \max(0,x) + \text{weight} * \min(0,x)` where weight is a
    learnable parameter.

    See :class:`~torch.nn.PReLU` for more details.
    """
    return torch.prelu(input, weight)
```

**4.  RReLUå‡½æ•°**ï¼ˆéšæœºä¿®æ­£çº¿æ€§å•å…ƒï¼‰

![](http://p0.ifengimg.com/pmop/2017/0701/B3F2F3EA627EBB55D88C8F8FB36942C56B350A4B_size14_w740_h221.jpeg)



RReLUæ˜¯Leaky ReLUçš„randomç‰ˆæœ¬ï¼Œåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼ŒÎ±æ˜¯ä»ä¸€ä¸ªé«˜æ–¯åˆ†å¸ƒ $U(l,u)$ ä¸­éšæœºå‡ºæ¥çš„å€¼ï¼Œç„¶åå†åœ¨æµ‹è¯•è¿‡ç¨‹ä¸­è¿›è¡Œä¿®æ­£ã€‚åœ¨æµ‹è¯•é˜¶æ®µï¼ŒæŠŠè®­ç»ƒè¿‡ç¨‹ä¸­æ‰€æœ‰çš„ $\alpha _{ij}$ å–ä¸ªå¹³å‡å€¼ã€‚

ä¸‹å›¾æ˜¯ReLUã€Leaky ReLUã€PReLUå’ŒRReLUçš„æ¯”è¾ƒï¼š

![](http://p0.ifengimg.com/pmop/2017/0701/C56E5C6FCBB36E70BA5EBC90CBD142BA320B3DF6_size19_w740_h217.jpeg)

**æ€»ç»“ï¼š**

ï¼ˆ1ï¼‰PReLUä¸­çš„Î±æ˜¯æ ¹æ®æ•°æ®å˜åŒ–çš„ï¼›

ï¼ˆ2ï¼‰Leaky ReLUä¸­çš„Î±æ˜¯å›ºå®šçš„ï¼›

ï¼ˆ3ï¼‰RReLUä¸­çš„Î±æ˜¯ä¸€ä¸ªåœ¨ç»™å®šèŒƒå›´å†…éšæœºæŠ½å–çš„å€¼ï¼Œè¿™ä¸ªå€¼åœ¨æµ‹è¯•ç¯èŠ‚å°±ä¼šå›ºå®šä¸‹æ¥ã€‚

**5. ELUå‡½æ•°ï¼š**ï¼ˆæŒ‡æ•°çº¿æ€§å•å…ƒï¼‰
$$a=\left\{\begin{array}{cc}
z & , z>0 \\
\alpha\left(e^{z}-1\right) & , z \leq 0
\end{array}\right.$$

ç±»ä¼¼äºLeaky ReLUï¼ŒELUçš„è´Ÿå€¼æ–œç‡è¾ƒå°ã€‚å®ƒä½¿ç”¨å¦‚ä¸‹æ‰€ç¤ºçš„å¯¹æ•°æ›²çº¿ä»£æ›¿ç›´çº¿ï¼š

![](https://img-blog.csdnimg.cn/20200405192225656.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MjAzMzQzNg==,size_16,color_FFFFFF,t_70)

ELUå‡½æ•°æ˜¯é’ˆå¯¹ReLUå‡½æ•°çš„ä¸€ä¸ªæ”¹è¿›å‹ï¼Œè®¾è®¡ç›®çš„æ˜¯ç»“åˆReLUçš„çº¿æ€§éƒ¨åˆ†å’ŒLeaky ReLUã€‚ç›¸æ¯”äºReLUå‡½æ•°ï¼Œåœ¨è¾“å…¥ä¸ºè´Ÿæ•°çš„æƒ…å†µä¸‹ï¼Œæ˜¯æœ‰ä¸€å®šçš„è¾“å‡ºçš„ï¼Œè€Œä¸”è¿™éƒ¨åˆ†è¾“å‡ºè¿˜å…·æœ‰ä¸€å®šçš„æŠ—å¹²æ‰°èƒ½åŠ›ï¼Œè¿™æ ·å¯ä»¥æ¶ˆé™¤ReLUæ­»æ‰çš„é—®é¢˜ï¼Œä¸è¿‡è¿˜æ˜¯æœ‰æ¢¯åº¦é¥±å’Œå’ŒæŒ‡æ•°è¿ç®—çš„é—®é¢˜ï¼Œåœ¨å¤§çš„è´Ÿæ•°éƒ¨åˆ†æ¢¯åº¦ä¸º0ï¼Œå¯¼è‡´ç¥ç»å…ƒä¸æ´»è·ƒã€‚

pytorchå®ç°ï¼š

```python
def elu(input, alpha=1., inplace=False):
    r"""Applies element-wise,
    :math:`\text{ELU}(x) = \max(0,x) + \min(0, \alpha * (\exp(x) - 1))`.

    See :class:`~torch.nn.ELU` for more details.
    """
    if inplace:
        return torch._C._nn.elu_(input, alpha)
    return torch._C._nn.elu(input, alpha)
```

**6. SELUå‡½æ•°ï¼š**

$$a=\lambda \left\{\begin{array}{cc}
z & , z>0 \\
\alpha\left(e^{z}-1\right) & , z \leq 0
\end{array}\right.$$

ç»è¿‡è¯¥æ¿€æ´»å‡½æ•°åä½¿å¾—æ ·æœ¬åˆ†å¸ƒè‡ªåŠ¨å½’ä¸€åŒ–åˆ°0å‡å€¼å’Œå•ä½æ–¹å·®(è‡ªå½’ä¸€åŒ–ï¼Œä¿è¯è®­ç»ƒè¿‡ç¨‹ä¸­æ¢¯åº¦ä¸ä¼šçˆ†ç‚¸æˆ–æ¶ˆå¤±ï¼Œæ•ˆæœæ¯”Batch Normalization è¦å¥½) ã€‚
â€‹å…¶å®å°±æ˜¯ELUä¹˜äº†ä¸ª $\lambda$ï¼Œå…³é”®åœ¨äºè¿™ä¸ª $\lambda$ æ˜¯å¤§äº1çš„ã€‚å‰é¢çš„ReLUã€PReLUã€ELUè¿™äº›æ¿€æ´»å‡½æ•°ï¼Œéƒ½æ˜¯åœ¨è´ŸåŠè½´å¡åº¦å¹³ç¼“ï¼Œè¿™æ ·åœ¨activationçš„æ–¹å·®è¿‡å¤§çš„æ—¶å€™å¯ä»¥è®©å®ƒå‡å°ï¼Œé˜²æ­¢äº†æ¢¯åº¦çˆ†ç‚¸ï¼Œä½†æ˜¯æ­£åŠè½´å¡åº¦ç®€å•çš„è®¾æˆäº†1ã€‚è€ŒSELUçš„æ­£åŠè½´å¤§äº1ï¼Œåœ¨æ–¹å·®è¿‡å°çš„çš„æ—¶å€™å¯ä»¥è®©å®ƒå¢å¤§ï¼ŒåŒæ—¶é˜²æ­¢äº†æ¢¯åº¦æ¶ˆå¤±ã€‚è¿™æ ·æ¿€æ´»å‡½æ•°å°±æœ‰ä¸€ä¸ªä¸åŠ¨ç‚¹ï¼Œç½‘ç»œæ·±äº†ä»¥åæ¯ä¸€å±‚çš„è¾“å‡ºéƒ½æ˜¯å‡å€¼ä¸º0æ–¹å·®ä¸º1ã€‚

pytorchå®ç°ï¼š

```python
def selu(input, inplace=False):
    r"""selu(input, inplace=False) -> Tensor

    Applies element-wise,
    :math:`\text{SELU}(x) = scale * (\max(0,x) + \min(0, \alpha * (\exp(x) - 1)))`,
    with :math:`\alpha=1.6732632423543772848170429916717` and
    :math:`scale=1.0507009873554804934193349852946`.

    See :class:`~torch.nn.SELU` for more details.
    """
    if inplace:
        return torch.selu_(input)
    return torch.selu(input)
```

**7. MaxOutå‡½æ•°**

![](https://upload-images.jianshu.io/upload_images/4155986-1b5bc20ed6ee1a1f.png?imageMogr2/auto-orient/strip|imageView2/2/format/webp)

è¿™é‡Œçš„Wæ˜¯3ç»´çš„ï¼Œå°ºå¯¸ä¸ºdÃ—mÃ—kï¼Œå…¶ä¸­dè¡¨ç¤ºè¾“å…¥å±‚èŠ‚ç‚¹çš„ä¸ªæ•°ï¼Œmè¡¨ç¤ºéšå«å±‚èŠ‚ç‚¹çš„ä¸ªæ•°ï¼Œkè¡¨ç¤ºæ¯ä¸ªéšå«å±‚èŠ‚ç‚¹å¯¹åº”äº†kä¸ªâ€éšéšå«å±‚â€èŠ‚ç‚¹ï¼Œè¿™kä¸ªâ€éšéšå«å±‚â€èŠ‚ç‚¹éƒ½æ˜¯çº¿æ€§è¾“å‡ºçš„ï¼Œè€Œmaxoutçš„æ¯ä¸ªèŠ‚ç‚¹å°±æ˜¯å–è¿™kä¸ªâ€éšéšå«å±‚â€èŠ‚ç‚¹è¾“å‡ºå€¼ä¸­æœ€å¤§çš„é‚£ä¸ªå€¼ã€‚å› ä¸ºæ¿€å‘å‡½æ•°ä¸­æœ‰äº†maxæ“ä½œï¼Œæ‰€ä»¥æ•´ä¸ªmaxoutç½‘ç»œä¹Ÿæ˜¯ä¸€ç§éçº¿æ€§çš„å˜æ¢ã€‚

maxoutçš„æ‹Ÿåˆèƒ½åŠ›éå¸¸å¼ºï¼Œå¯ä»¥æ‹Ÿåˆä»»æ„çš„å‡¸å‡½æ•°(åŒ…æ‹¬ReLU)ã€‚

**8. Swishå‡½æ•°**

$a=z * sigmoid(z)$

å…¶å˜å½¢Swish-Bæ¿€æ´»å‡½æ•°çš„å…¬å¼ï¼š$a=z * sigmoid(b * z)$

![](https://img-blog.csdn.net/20171126110946276)

Swishæ˜¯Googleæå‡ºçš„ä¸€ç§æ–°å‹æ¿€æ´»å‡½æ•°ï¼Œæ‹¥æœ‰ä¸é¥±å’Œã€å…‰æ»‘ã€éå•è°ƒæ€§çš„ç‰¹å¾ï¼Œè€ŒGoogleåœ¨è®ºæ–‡ä¸­çš„å¤šé¡¹æµ‹è¯•è¡¨æ˜Swishä»¥åŠSwish-Bæ¿€æ´»å‡½æ•°çš„æ€§èƒ½æä½³ï¼Œåœ¨ä¸åŒçš„æ•°æ®é›†ä¸Šéƒ½è¡¨ç°å‡ºäº†è¦ä¼˜äºå½“å‰æœ€ä½³æ¿€æ´»å‡½æ•°çš„æ€§èƒ½ã€‚

#### 3.4.3 å¦‚ä½•é€‰æ‹©æ¿€æ´»å‡½æ•°

åœ¨å®è·µè¿‡ç¨‹ä¸­é€‰æ‹©æ¿€æ´»å‡½æ•°æ—¶æ›´å¤šè¿˜æ˜¯éœ€è¦ç»“åˆå®é™…æƒ…å†µï¼Œè€ƒè™‘ä¸åŒæ¿€æ´»å‡½æ•°çš„ä¼˜ç¼ºç‚¹ç»¼åˆä½¿ç”¨ï¼Œè¿™é‡Œæå‡ºä¸€ç‚¹åœ¨è®­ç»ƒæ¨¡å‹æ—¶é€‰æ‹©æ¿€æ´»å‡½æ•°çš„å»ºè®®ã€‚

ï¼ˆ1ï¼‰é¦–å…ˆå°è¯•ReLUï¼Œé€Ÿåº¦å¿«ï¼Œä½†è¦æ³¨æ„è®­ç»ƒçš„çŠ¶æ€ã€‚

ï¼ˆ2ï¼‰å¦‚æœReLUæ•ˆæœæ¬ ä½³ï¼Œå°è¯•Leaky ReLUæˆ–Maxoutç­‰å˜ç§ã€‚

ï¼ˆ3ï¼‰å°è¯•tanhæ­£åˆ‡å‡½æ•°(ä»¥é›¶ç‚¹ä¸ºä¸­å¿ƒï¼Œé›¶ç‚¹å¤„æ¢¯åº¦ä¸º1)ã€‚

ï¼ˆ4ï¼‰sigmoid/tanhåœ¨RNNï¼ˆLSTMã€æ³¨æ„åŠ›æœºåˆ¶ç­‰ï¼‰ç»“æ„ä¸­æœ‰æ‰€åº”ç”¨ï¼Œä½œä¸ºé—¨æ§æˆ–è€…æ¦‚ç‡å€¼ã€‚

ï¼ˆ5ï¼‰åœ¨æµ…å±‚ç¥ç»ç½‘ç»œä¸­ï¼Œå¦‚ä¸è¶…è¿‡4å±‚çš„ï¼Œå¯é€‰æ‹©ä½¿ç”¨å¤šç§æ¿€åŠ±å‡½æ•°ï¼Œæ²¡æœ‰å¤ªå¤§çš„å½±å“ã€‚

#### 3.4.4 è¾“å‡ºå±‚å¯ä»¥ä¸åŠ æ¿€æ´»å‡½æ•°å—ï¼Ÿ

â€‹		è¾“å…¥å±‚å’Œéšè—å±‚çš„æ¿€æ´»å‡½æ•°å‚ä¸äº†æ•´ä¸ªå‰å‘å’Œåå‘ä¼ æ’­ï¼Œç›¸å½“äºåŠ å…¥äº†éçº¿æ€§å› ç´ ï¼Œå¦‚æœåœ¨è¾“å…¥å’Œéšè—å±‚æ²¡æœ‰æ¿€æ´»å‡½æ•°ï¼Œé‚£ä¹ˆæ•´ä¸ªç¥ç»ç½‘ç»œç›¸å½“äºåªæ˜¯ä¸€ä¸ªçŸ©é˜µçš„è¿ç®—ï¼Œåªèƒ½å¾—åˆ°ä¸€äº›çº¿æ€§ç»„åˆã€‚ä½†å¯¹äºè¾“å‡ºå±‚æ¥è¯´ï¼ŒåŠ ä¸åŠ æ¿€æ´»å‡½æ•°å¯¹å‰å‘å’Œåå‘ä¼ æ’­å…¶å®æ²¡æœ‰ä»»ä½•å½±å“ï¼Œæ¿€æ´»å‡½æ•°çš„ä½œç”¨ç›¸å½“äºæ•´å½¢ï¼Œæ•…ä¸€èˆ¬è¾“å‡ºå±‚å¯ä»¥ä¸åŠ æ¿€æ´»å‡½æ•°ã€‚ä½†æ˜¯ï¼Œå½“éœ€è¦æ§åˆ¶è¾“å‡ºåœ¨ä¸€å®šèŒƒå›´ï¼ˆsigmoidï¼‰æˆ–è€…å¸Œæœ›è¾“å‡ºæ»¡è¶³ä¸€å®šçš„åˆ†å¸ƒï¼ˆsoftmaxï¼‰å†æˆ–è€…ç¥ç»ç½‘ç»œçš„è¾“å‡ºå±‚åé¢è¿˜è¦æ¥å…¶ä»–çš„ä¸œè¥¿ï¼ˆæ¯”å¦‚GANä¸­ç”Ÿæˆå™¨ç½‘ç»œçš„è¾“å‡ºè¿˜è¦æ¥åˆ¤åˆ«å™¨ï¼‰ï¼Œå°±å¿…é¡»åœ¨è¾“å‡ºå±‚åŠ æ¿€æ´»å‡½æ•°ã€‚

### 3.5 ä¸ºä»€ä¹ˆéœ€è¦éçº¿æ€§æ¿€æ´»å‡½æ•°

#### 3.5.1 çº¿æ€§åˆ†ç±»å™¨å’Œéçº¿æ€§åˆ†ç±»å™¨

**çº¿æ€§åˆ†ç±»å™¨**ï¼šåªè€ƒè™‘äºŒç±»çš„æƒ…å½¢ï¼Œæ‰€è°“çº¿æ€§åˆ†ç±»å™¨å³ç”¨ä¸€ä¸ª**è¶…å¹³é¢**å°†æ­£è´Ÿæ ·æœ¬åˆ†ç¦»å¼€ï¼Œæ¨¡å‹æ˜¯å‚æ•°çš„çº¿æ€§å‡½æ•°ï¼Œå¦‚$y=wx$ï¼Œåœ¨çº¿æ€§åˆ†ç±»å™¨çš„åŸºç¡€ä¸Šï¼Œç”¨åˆ†æ®µçº¿æ€§åˆ†ç±»å™¨å¯ä»¥å®ç°æ›´å¤æ‚çš„åˆ†ç±»é¢ã€‚

å¸¸è§çš„çº¿æ€§åˆ†ç±»å™¨ï¼šLRï¼Œè´å¶æ–¯åˆ†ç±»ï¼Œå•å±‚æ„ŸçŸ¥æœºã€çº¿æ€§å›å½’ï¼ŒSVMï¼ˆçº¿æ€§æ ¸ï¼‰ç­‰ã€‚
ä¼˜ç¼ºç‚¹ï¼šç®—æ³•ç®€å•å¹¶å…·æœ‰â€œå­¦ä¹ â€èƒ½åŠ›ã€‚çº¿æ€§åˆ†ç±»å™¨é€Ÿåº¦å¿«ã€ç¼–ç¨‹æ–¹ä¾¿ï¼Œä½†å¯èƒ½æ‹Ÿåˆæ•ˆæœä¸ä¼šå¾ˆå¥½ã€‚

**éçº¿æ€§åˆ†ç±»å™¨**ï¼šæ¨¡å‹åˆ†ç•Œé¢å¯ä»¥æ˜¯**æ›²é¢**æˆ–è€…**è¶…å¹³é¢çš„ç»„åˆ**ã€‚éçº¿æ€§åˆ¤åˆ«å‡½æ•°è§£å†³æ¯”è¾ƒå¤æ‚çš„çº¿æ€§ä¸å¯åˆ†æ ·æœ¬åˆ†ç±»é—®é¢˜ï¼Œè§£å†³é—®é¢˜æ¯”è¾ƒç®€ä¾¿çš„æ–¹æ³•æ˜¯é‡‡ç”¨å¤šä¸ªçº¿æ€§åˆ†ç•Œé¢å°†å®ƒä»¬åˆ†æ®µè¿æ¥ï¼Œç”¨åˆ†æ®µçº¿æ€§åˆ¤åˆ«åˆ’åˆ†å»é€¼è¿‘åˆ†ç•Œçš„è¶…æ›²é¢ã€‚

å¸¸è§çš„éçº¿æ€§åˆ†ç±»å™¨ï¼šå†³ç­–æ ‘ã€RFã€GBDTã€å¤šå±‚æ„ŸçŸ¥æœºã€SVMï¼ˆé«˜æ–¯æ ¸ï¼‰ç­‰ã€‚
ä¼˜ç¼ºç‚¹ï¼šéçº¿æ€§åˆ†ç±»å™¨ç¼–ç¨‹å¤æ‚ï¼Œä½†æ˜¯æ•ˆæœæ‹Ÿåˆèƒ½åŠ›å¼ºã€‚

#### 3.5.2 çº¿æ€§æ¿€æ´»å‡½æ•°å’Œéçº¿æ€§æ¿€æ´»å‡½æ•°

çº¿æ€§æ¿€æ´»å‡½æ•°ä¹Ÿç§°ä¸ºæ’ç­‰æ¿€æ´»å‡½æ•°ï¼Œå‡è®¾ä½¿ç”¨çš„çº¿æ€§æ¿€æ´»å‡½æ•°ä¸º$g(z)=z$ï¼Œå³æŠŠ$a^{[1]}=z^{[1]}$, $a^{[2]}=z^{[2]}$ä»£å…¥å‰é¢å•éšå±‚ç¥ç»ç½‘ç»œçš„è®¡ç®—å…¬å¼ä¸­ï¼Œæœ‰ï¼š

(1) $a^{[1]}=z^{[1]}=W^{[1]} x+b^{[1]}$
(2) $a^{[2]}=z^{[2]}=W^{[2]} a^{[1]}+b^{[2]}$ 
å°†(1)å¼å¸¦å…¥(2)å¼ä¸­ï¼Œåˆ™ï¼š
$$
a^{[2]}=z^{[2]}=W^{[2]}\left(W^{[1]} x+b^{[1]}\right)+b^{[2]}=W^{[2]} W^{[1]} x+W^{[2]} b^{[1]}+b^{[2]}
$$
åŒ–ç®€å¾—$a^{[2]}=z^{[2]}=W^{\prime} x+b^{\prime}$

ç”±ä¸Šå¼å‘ç°ï¼Œè‹¥ä½¿ç”¨çº¿æ€§æ¿€æ´»å‡½æ•°ï¼Œç¥ç»ç½‘ç»œåªæ˜¯æŠŠè¾“å…¥çº¿æ€§ç»„åˆå†è¾“å‡ºï¼Œæ— è®ºç¥ç»ç½‘ç»œæœ‰å¤šå°‘å±‚éƒ½ä¸€ç›´åªæ˜¯åœ¨è®¡ç®—çº¿æ€§å‡½æ•°ï¼Œçº¿æ€§éšè—å±‚ä¸€ç‚¹ç”¨ä¹Ÿæ²¡æœ‰ï¼Œæ¨¡å‹å¤æ‚ç¨‹åº¦å’Œæ²¡æœ‰ä»»ä½•éšè—å±‚çš„æ ‡å‡† logistic å›å½’ç›¸åŒã€‚

å½“è¦æœºå™¨å­¦ä¹ çš„æ˜¯å›å½’é—®é¢˜æ—¶ï¼Œå¦‚æœ${y}$ä¸ºå®æ•°ï¼Œåœ¨è¾“å‡ºå±‚ç”¨çº¿æ€§æ¿€æ´»å‡½æ•°ä¹Ÿè®¸å¯è¡Œï¼Œæ­¤æ—¶è¾“å‡ºä¹Ÿæ˜¯ä¸€ä¸ªå®æ•°ï¼Œä»è´Ÿæ— ç©·åˆ°æ­£æ— ç©·ã€‚

**ç»“è®º**
ä¸èƒ½åœ¨éšè—å±‚ç”¨çº¿æ€§æ¿€æ´»å‡½æ•°ï¼Œå¯ç”¨**ReLU** ã€**tanh** æˆ– **leaky ReLU** ç­‰éçº¿æ€§æ¿€æ´»å‡½æ•°ã€‚å”¯ä¸€å¯ç”¨çº¿æ€§æ¿€æ´»å‡½æ•°çš„å°±æ˜¯è¾“å‡ºå±‚ã€‚

### 3.6 æ¿€æ´»å‡½æ•°çš„å¯¼æ•°

åœ¨ç¥ç»ç½‘ç»œä¸­ä½¿ç”¨åå‘ä¼ æ’­æ—¶ï¼Œéœ€è¦è®¡ç®—æ¿€æ´»å‡½æ•°çš„å¯¼æ•°ã€‚
1. **sigmoid:** $g(z)=\frac{1}{1+e^{-z}}$

![](https://upload-images.jianshu.io/upload_images/24408091-9a5fa6145ba979dd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
æ±‚å¯¼å…¬å¼ï¼š
$$
\frac{d}{d z} g(z)=\frac{1}{1+e^{-z}}\left(1-\frac{1}{1+e^{-z}}\right)=g(z)(1-g(z))
$$
åœ¨ç¥ç»ç½‘ç»œä¸­
$$
a=g(z)\\
g^{\prime}(z)=\frac{d}{d z} g(z)=a(1-a)
$$

2. **tanh:** $g(z)=\tanh (z)$ $=\frac{e^{z}-e^{-z}}{e^{z}+e^{-z}}$
![](https://upload-images.jianshu.io/upload_images/24408091-4c16ab4cb118e005.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

æ±‚å¯¼å…¬å¼ï¼š
$$
\frac{d}{d z} g(z)=1-(\tanh (z))^{2}
$$
åœ¨ç¥ç»ç½‘ç»œä¸­
$$
a=g(z) \\
g(z)^{\prime}=\frac{d}{d z} g(z)=1-a^{2}
$$

3.  **ReLU:**$g(z)=\max (0, z)$
![](https://upload-images.jianshu.io/upload_images/24408091-7e9670d58cfa0e42.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

$$
g(z)^{\prime}=\left\{\begin{array}{ll}
0 & \text { if } z<0 \\
1 & \text { if } z>0 \\
undefined & \text { if } z=0
\end{array}\right.
$$

é€šå¸¸åœ¨ $z = 0 $æ—¶ï¼Œå¯ä»¥ç»™å®šå…¶å¯¼æ•°ä¸º 1 æˆ– 0ï¼Œä¸€èˆ¬$ğ‘§=0 $çš„æƒ…å†µå¾ˆå°‘ã€‚

4. **leaky ReLU:** $g(z)=\max (0.01 z, z)$
    ![](https://upload-images.jianshu.io/upload_images/24408091-508742c3269c915c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
$$
  g(z)^{\prime}=\left\{\begin{array}{ll}
  0.01 & \text { if } z<0 \\
  1 & \text { if } z>0 \\
  undefined & \text { if } z=0
  \end{array}\right.
$$
  é€šå¸¸åœ¨ $z = 0 $æ—¶ï¼Œå¯ä»¥ç»™å®šå…¶å¯¼æ•°ä¸º 1 æˆ– 0.01ï¼Œä¸€èˆ¬$ğ‘§=0 $çš„æƒ…å†µå¾ˆå°‘ã€‚

### 3.7 ç¥ç»ç½‘ç»œçš„æ¢¯åº¦ä¸‹é™æ³•
é¦–å…ˆï¼Œç®€å•å›é¡¾ä¸€ä¸‹å•éšå±‚ç½‘ç»œçš„ç›¸å…³å‚æ•°ï¼š$$W^{[i]}, b^{[i]}, n^{[i]}$$
åˆ†åˆ«è¡¨ç¤ºç¥ç»ç½‘ç»œç¬¬$i$å±‚çš„æƒå€¼çŸ©é˜µã€åç½®å’ŒèŠ‚ç‚¹æ•°ã€‚
å…¶ä¸­æƒå€¼çŸ©é˜µå’Œåç½®çš„shapeåˆ†åˆ«ä¸ºï¼š$$(n^{[i]}, n^{[i-1]}), (n^{[i]}, 1)$$
**costå‡½æ•°**ï¼š
$$
J(W^{[1]}, b^{[1]}, W^{[2]}b^{[2]}) = \frac{1}{m} \sum_{i=1}^{n} L(\hat{y}, y)
$$
å…¶ä¸­çš„ $\hat{y}$ åˆç­‰äº $a^{[2]}$ã€‚

**æ¢¯åº¦ä¸‹é™**(è®­ç»ƒå‚æ•°)ï¼š
(1) éšæœºåˆå§‹åŒ–
åœ¨è®­ç»ƒç¥ç»ç½‘ç»œæ—¶ï¼Œéšæœºåˆå§‹åŒ–å‚æ•°å¾ˆé‡è¦ï¼Œè€Œä¸æ˜¯å…¨åˆå§‹åŒ–ä¸º0ã€‚æŠŠå‚æ•°åˆå§‹åŒ–ä¸ºæŸäº›å€¼åï¼Œæ¯ä¸ªæ¢¯åº¦ä¸‹é™å¾ªç¯éƒ½ä¼šè®¡ç®—é¢„æµ‹å€¼ï¼Œæ‰€ä»¥åŸºæœ¬ä¸Šéœ€è¦è®¡ç®—i=1åˆ°mçš„é¢„æµ‹å€¼$\hat y$ã€‚

(2) è®¡ç®—å¯¼æ•°ï¼š
$$
dW^{[i]}=\frac{\partial J}{\partial W^{[i]}} \\
db^{[i]}=\frac{\partial J}{\partial b^{[i]}}
$$
(3) æ›´æ–°å‚æ•°ï¼š
$$
W^{[i]}=W^{[i]}-\alpha \cdot d W^{[i]} \\
b^{[i]}=b^{[i]}-\alpha \cdot d b^{[i]}
$$
é‡å¤ä»¥ä¸Šæ­¥éª¤(2)ã€(3)ç›´è‡³å‚æ•°æ”¶æ•›ã€‚

å•éšå±‚ç¥ç»ç½‘ç»œçš„è®¡ç®—è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š
![](https://upload-images.jianshu.io/upload_images/16793245-a1c9f6bc82c9b83a.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

#### 3.7.1 æ­£å‘ä¼ æ’­ ####
æ­£å‘ä¼ æ’­æ¯”è¾ƒç®€å•ï¼Œç›´æ¥ä»£å…¥å·²çŸ¥æ•°å€¼æŒ‰æ­¥éª¤è®¡ç®—å°±å¯ä»¥äº†ã€‚å…¬å¼å¦‚ä¸‹ï¼š
$$
Z^{[1]}=W^{[1]}X+b^{[1]},A^{[1]}=g^{[1]}(Z^{[1]})\\
Z^{[2]}=W^{[2]}A^{[1]}+b^{[2]},A^{[2]}=g^{[2]}(Z^{[2]})
$$
å¯¹äºäºŒåˆ†ç±»æ¨¡å‹æ¥è¯´ï¼Œå…¶ä¸­çš„$g^{[2]}(Z^{[2]})=\sigma(Z^{[2]})$
å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæ­¤å¤„ç”¨çš„æ˜¯å¤§å†™å­—æ¯Zå’ŒAï¼Œå’Œå›¾ç‰‡ä¸ä¸€è‡´ã€‚æ„å‘³ç€è¿™æ˜¯å°†æ‰€æœ‰æ ·æœ¬**å‘é‡åŒ–**å †å åœ¨ä¸€èµ·äº†ã€‚ä¸‹æ–‡ä¹Ÿåº”å½“æ³¨æ„åˆ°å¤§å°å†™çš„åŒºåˆ«ã€‚

#### 3.7.2 åå‘ä¼ æ’­ ####
åå‘ä¼ æ’­åˆ™æ˜¯æŒ‡æ¢¯åº¦çš„ä»åå¾€å‰è®¡ç®—ã€‚å…¬å¼å¦‚ä¸‹ï¼š
$$
dZ^{[2]}=A^{[2]}-Y \\
dW^{[2]}=\frac{1}{m} dZ^{[2]}A^{[1]T} \\
db^{[2]}=\frac{1}{m} np.sum(dZ^{[ 2 ]}, axis=1, keepdims=True) \\

dZ^{[1]}=W^{[2]T}dZ^{[2]}*g^{[1]'}(Z^{[1]}) \\
dW^{[1]}=\frac{1}{m} dZ^{[1]}X^{T} \\
db^{[1]}=\frac{1}{m} np.sum(dZ^{[1]}, axis=1, keepdims=True)
$$
å…¶ä¸­$Y=[y^{(1)}, y^{(2)}, ..., y^{(m)}]$ï¼Œ$g^{[1]'}$ä¸ºæ¿€æ´»å‡½æ•°$g^{[1]}$çš„å¯¼æ•°ã€‚

ä¸éš¾å‘ç°ï¼Œ$dW$å’Œ$db$çš„è®¡ç®—ç›¸å½“ç›¸ä¼¼ï¼Œå¯èƒ½æœ‰äººæƒ³é‚£æ˜¯ä¸æ˜¯ä¹Ÿå¯ä»¥å‘é‡åŒ–æ¥å‡å°‘ä»£ç é‡ï¼Ÿä½†æ˜¯å‘é‡åŒ–çš„åŸºæœ¬å‰ææ˜¯ä¸¤ä¸ªå‘é‡çš„shapeè¦ä¸€è‡´ï¼Œä½†è¿™é‡Œå¾ˆæ˜æ˜¾ä¸ç¬¦åˆã€‚

### 3.8 ç›´è§‚ç†è§£åå‘ä¼ æ’­ ###
#### 3.8.1 å•ä¸ªæ ·æœ¬çš„æ¢¯åº¦

å¯¹äºå•ä¸ªæ ·æœ¬ï¼Œ$dz^{[2]}$çš„è®¡ç®—å¯ä»¥å›é¡¾å‰é¢çš„logisticå›å½’ï¼Œç®€å•æ¥è¯´æ˜¯å…ˆè®¡ç®—$a^{[2]}$ï¼Œå†è®¡ç®—$dz^{[2]}$ï¼Œæ­¤å¤„ä¸å†èµ˜è¿°ã€‚
å¦‚æœä½ æœ‰å¾®ç§¯åˆ†ç›¸å…³çŸ¥è¯†çš„åŸºç¡€ï¼Œé‚£ç†è§£$dW, db$çš„è®¡ç®—åº”è¯¥ä¹Ÿä¸æ˜¯å¾ˆå›°éš¾ï¼Œè€Œä¸”æ— è®ºå“ªä¸€å±‚éƒ½æœ‰ç€ç±»ä¼¼çš„è®¡ç®—ã€‚
é‚£æœ€éš¾ç†è§£çš„éƒ¨åˆ†å¯èƒ½æ˜¯$dz^{[1]}$çš„è®¡ç®—ã€‚é¦–å…ˆæ ¹æ®é“¾å¼æ³•åˆ™ï¼Œæ˜“å¾—ï¼š
$$
dz^{[1]}=\frac{dL}{dz^{[2]}}\frac{dz^{[2]}}{da^{[1]}}\frac{da^{[1]}}{dz^{[1]}}
$$
ç„¶åå°†å·²ç»è®¡ç®—å¾—åˆ°ç»“æœçš„ï¼š
$$
\frac{dL}{dz^{[2]}}=dz^{[2]}
$$
å’Œ
$$
\frac{dz^{[2]}}{da^{[1]}}=W^{[2]} \\
\frac{da^{[1]}}{dz^{[1]}}=g^{[1]'}(z^{[1]})
$$
ä»£å…¥ï¼Œå°±å¯å¾—åˆ°ç›®æ ‡å¼ï¼š
$$
dz^{[1]}=W^{[2]T}dz^{[2]}*g^{[1]'}(z^{[1]})
$$

#### 3.8.2 å¤šæ ·æœ¬å‘é‡åŒ– ####
åˆšåˆšæ˜¯é’ˆå¯¹å•ä¸ªæ ·æœ¬ï¼Œç°åœ¨ç»™å‡ºå‘é‡åŒ–åçš„**åˆç†æ€§**ï¼Œä¸åšè¿‡å¤šè§£é‡Šã€‚
å‘é‡åŒ–åçš„$Z$:
$$
Z^{[1]}=[z^{[1](1)}, z^{[1](2)}, ..., z^{[1](m)}]
$$
æ˜¯å°†mä¸ªæ ·æœ¬ï¼ˆæœ¬æ¥æ˜¯åˆ—å‘é‡ï¼‰æŒ‰â€œè¡Œå‘é‡â€ç»„åˆæˆäº†â€œçŸ©é˜µâ€ã€‚
ç”¨shapeæ¥éªŒè¯ä¸€ä¸‹å¯¹ä¸å¯¹ï¼š
$$
x:(n^{[0]}, 1), W^{[1]}:(n^{[1]}, n0), b^{[1]}:(n^{[1]}, 1) \\
W^{[1]}x+b^{[1]}=z^{[1]}:(n^{[1]}, 1)
$$

$$
X:(n^{[0]},m), W^{[1]}:(n^{[1]}, n0), b^{[1]}:(n^{[1]}, 1) \\
W^{[1]}X+b^{[1]}=Z^{[1]}:(n^{[1]}, m)
$$

çœ‹èµ·æ¥ç¡®å®ç¬¦åˆï¼Œç”±åŸæ¥çš„1åˆ—å †å æˆäº†måˆ—ã€‚ç›¸åº”çš„ï¼Œ$A^{[1]}$ä¹Ÿä¸ºå †å ä¹‹åçš„$(n^{[1]}, m)$ã€‚å¯¹äº$Z^{[2]}, A^{[2]}$åŒç†ï¼Œå¯è‡ªè¡Œæ¨å¯¼ã€‚

### 3.9 éšæœºåˆå§‹åŒ– ###

åœ¨å­¦ä¹ logisticå›å½’æ—¶ï¼Œæˆ‘ä»¬åˆå§‹åŒ–æƒå€¼çŸ©é˜µå’Œåç½®çš„æ—¶å€™éƒ½æ˜¯åˆå§‹ä¸º0çš„ã€‚åœ¨logisticå›å½’ä¸­ï¼Œè¿™ä¹ˆåšç¡®å®æ²¡ä»€ä¹ˆé—®é¢˜ï¼›ä½†åœ¨æ›´å¤æ‚ã€æ›´æ·±çš„ç¥ç»ç½‘ç»œä¸­ï¼Œç»Ÿä¸€çš„åˆå§‹åŒ–ä¼šå¯¼è‡´å­¦ä¹ æ•ˆæœå·®å¾ˆå¤šã€‚æ¥ä¸‹æ¥åˆ†æåŸå› å¹¶ä»‹ç»å…¶ä»–çš„åˆå§‹åŒ–åšæ³•ã€‚

#### 3.9.1 åŸå›  ####
åœ¨ç¥ç»ç½‘ç»œä¸­ï¼Œä¸€ä¸ªæƒå€¼çŸ©é˜µ$W$ï¼Œæ¯ä¸€è¡Œéƒ½å¯ä»¥è§†ä¸ºä¸€ä¸ªâ€œç‰¹å¾æå–å™¨â€ã€‚è€Œç”±äºå¯¹ç§°æ€§ï¼Œå¦‚æœæ¯ä¸€è¡Œéƒ½åˆå§‹åŒ–ä¸ºä¸€æ ·çš„å€¼ï¼Œé‚£ä¼šå¯¼è‡´æ¯ä¸€ä¸ªç‰¹å¾æå–å™¨éƒ½åœ¨è®¡ç®—ä¸€æ¨¡ä¸€æ ·çš„ç‰¹å¾ï¼Œå³æ¯ä¸€è¡Œçš„ç»“æœéƒ½ä¸€è‡´ï¼Œæ¯ä¸€æ¬¡æ¢¯åº¦æ›´æ–°ä¹Ÿä¸€è‡´ï¼Œæœ€ç»ˆå¯¼è‡´è¿™ä¸ªæƒå€¼çŸ©é˜µåªæœ‰ä¸€è¡Œæ˜¯åœ¨è¿›è¡Œæœ‰æ•ˆè®¡ç®—çš„ï¼Œå…¶ä½™éƒ½æ˜¯**å®Œå…¨**é‡å¤çš„æ— ç”¨åŠŸã€‚å¯ä»¥å‘ç°ï¼š
$$
\text { dW }=\left[\begin{array}{cc}
u & v \\
u & v
\end{array}\right]
$$
ä¸éš¾æƒ³è±¡ï¼Œè¿™æ ·ä¸‹å»ä¼šå¯¼è‡´ç½‘ç»œçš„å­¦ä¹ æ•ˆæœå¾ˆå·®ã€‚
#### 3.9.2 è§£å†³åŠæ³•â€”â€”éšæœºåˆå§‹åŒ– ####
å¯¹äº$W$ï¼Œåˆå§‹åŒ–å¿…é¡»è¦**ç ´åå¯¹ç§°æ€§**æ‰èƒ½è®©æƒå€¼çŸ©é˜µå‘æŒ¥çœŸæ­£çš„ä½œç”¨ï¼Œè€Œå¯¹äºåç½®$b$åˆ™æ²¡æœ‰è¦æ±‚ï¼ˆåŸå› ä¸‹é¢è®²ï¼‰ã€‚
ç»™å‡ºçš„ä»£ç ç”¨çš„æ˜¯Python3ï¼ŒPython2å¯èƒ½ä¼šæœ‰æ‰€å·®åˆ«ã€‚

```python
# randnå‚æ•°ä¸ºå¯¹åº”çš„è½´çš„ç»´æ•°ï¼Œå‚æ•°æ ¼å¼å’ŒzerosåŒºåˆ†å¼€å¼€
W = np.random.randn(2, 2)*0.01
# zerosçš„å‚æ•°ä¸ºä¸€ä¸ªlistæˆ–è€…tupleï¼Œç›¸å½“äºshape
b = np.zeros((2, 1))
```
ä¹˜0.01æ˜¯å› ä¸ºè¦æŠŠWéšæœºåˆå§‹åŒ–åˆ°ä¸€ä¸ªç›¸å¯¹è¾ƒå°çš„å€¼ï¼Œå› ä¸ºå¦‚æœXå¾ˆå¤§çš„è¯ï¼ŒWåˆç›¸å¯¹è¾ƒå¤§ï¼Œä¼šå¯¼è‡´Zéå¸¸å¤§ï¼Œè¿™æ ·å¦‚æœæ¿€æ´»å‡½æ•°æ˜¯sigmoidï¼Œå°±ä¼šå¯¼è‡´sigmoidçš„è¾“å‡ºå€¼1æˆ–è€…0ï¼Œç„¶åä¼šå¯¼è‡´ä¸€ç³»åˆ—é—®é¢˜ï¼ˆæ¯”å¦‚cost functionè®¡ç®—çš„æ—¶å€™ï¼Œlogé‡Œæ˜¯0ï¼Œè¿™æ ·ä¼šæœ‰ç‚¹éº»çƒ¦ï¼‰ã€‚éšæœºåˆå§‹åŒ–åï¼Œcost functionéšç€è¿­ä»£æ¬¡æ•°çš„å˜åŒ–ç¤ºæ„å›¾ä¸ºï¼š

![](https://upload-images.jianshu.io/upload_images/24408463-e70635688309ffec.png?imageMogr2/auto-orient/strip|imageView2/2/format/webp)

èƒ½å¤Ÿçœ‹å‡ºï¼Œcost functionçš„å˜åŒ–æ˜¯æ¯”è¾ƒæ­£å¸¸çš„ã€‚ä½†æ˜¯éšæœºåˆå§‹åŒ–ä¹Ÿæœ‰ç¼ºç‚¹ï¼Œnp.random.randn()å…¶å®æ˜¯ä¸€ä¸ªå‡å€¼ä¸º0ï¼Œæ–¹å·®ä¸º1çš„é«˜æ–¯åˆ†å¸ƒä¸­é‡‡æ ·ã€‚å½“ç¥ç»ç½‘ç»œçš„å±‚æ•°å¢å¤šæ—¶ï¼Œä¼šå‘ç°è¶Šå¾€åé¢çš„å±‚çš„æ¿€æ´»å‡½æ•°ï¼ˆä½¿ç”¨tanHï¼‰çš„è¾“å‡ºå€¼å‡ ä¹éƒ½æ¥è¿‘äº0ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![](https://upload-images.jianshu.io/upload_images/24408463-1479075150947769.png?imageMogr2/auto-orient/strip|imageView2/2/format/webp)

æ¿€æ´»å‡½æ•°è¾“å‡ºå€¼æ¥è¿‘äº0ä¼šå¯¼è‡´æ¢¯åº¦éå¸¸æ¥è¿‘äº0ï¼Œå› æ­¤ä¼šå¯¼è‡´æ¢¯åº¦æ¶ˆå¤±ã€‚

å…³äº$b$å¯ä»¥åˆå§‹åŒ–ä¸º0çš„è§£é‡Šï¼šç»è¿‡ç‰¹å¾æå–åï¼Œæ¯ä¸€è¡Œä¸ºä¸€ä¸ªç‰¹å¾ï¼Œåç½®çš„ä½œç”¨å°±æ˜¯é’ˆå¯¹æ¯ä¸ªç‰¹å¾ï¼ˆæ¯ä¸€è¡Œï¼‰è¿›è¡Œä¸€æ¬¡â€œåç§»ä¿®æ­£â€ã€‚é‚£åªè¦ä¿è¯æ¯ä¸€è¡Œè®¡ç®—å‡ºæ¥çš„ç‰¹å¾ä¸ä¸€è‡´ï¼Œå°±å¯ä»¥ä¿è¯æ¯ä¸€è¡Œçš„æ›´æ–°ä¹Ÿä¸ä¸€è‡´ã€‚

#### 3.9.3 å…¶ä»–åˆå§‹åŒ–æ–¹æ³•

**1. Xavier åˆå§‹åŒ– **

åŸºæœ¬æ€æƒ³ï¼šå°½å¯èƒ½çš„è®©è¾“å…¥å’Œè¾“å‡ºæœä»ç›¸åŒçš„åˆ†å¸ƒï¼Œè¿™æ ·å°±èƒ½å¤Ÿé¿å…åé¢å±‚çš„æ¿€æ´»å‡½æ•°çš„è¾“å‡ºå€¼è¶‹å‘äº0ã€‚è™½ç„¶åˆšå¼€å§‹çš„æ¨å¯¼åŸºäºçº¿æ€§å‡½æ•°ï¼Œä½†æ˜¯åœ¨ä¸€äº›éçº¿æ€§ç¥ç»å…ƒä¹Ÿå¾ˆæœ‰æ•ˆã€‚

Xavier åˆå§‹åŒ–ä»£ç ï¼š

```python
tf.Variable(np.random.randn(node_in,node_out))/np.sqrt(node_in)
```

æ¥çœ‹ä¸‹Xavier initializationåæ¯å±‚çš„æ¿€æ´»å‡½æ•°è¾“å‡ºå€¼çš„åˆ†å¸ƒï¼š

![](https://upload-images.jianshu.io/upload_images/24408463-e8c8fc89b9f80cde.png?imageMogr2/auto-orient/strip|imageView2/2/format/webp)

èƒ½å¤Ÿçœ‹å‡ºï¼Œæ·±å±‚çš„æ¿€æ´»å‡½æ•°è¾“å‡ºå€¼è¿˜æ˜¯éå¸¸æ¼‚äº®çš„æœä»æ ‡å‡†é«˜æ–¯åˆ†å¸ƒã€‚è™½ç„¶Xavier initializationèƒ½å¤Ÿå¾ˆå¥½åœ°é…åˆtanH æ¿€æ´»å‡½æ•°è¾“å‡ºï¼Œä½†æ˜¯å¯¹äºç›®å‰ç¥ç»ç½‘ç»œä¸­æœ€å¸¸ç”¨çš„ReLUæ¿€æ´»å‡½æ•°ï¼Œè¿˜æ˜¯æ— èƒ½ä¸ºåŠ›ï¼Œè¯·çœ‹ä¸‹å›¾ï¼š

![](https://upload-images.jianshu.io/upload_images/24408463-042b50c2ba6a8528.png?imageMogr2/auto-orient/strip|imageView2/2/format/webp)

å½“è¾¾åˆ°5ï¼Œ6å±‚åå‡ ä¹åˆå¼€å§‹è¶‹å‘äº0ï¼Œæ›´æ·±å±‚çš„è¯å¾ˆæ˜æ˜¾åˆä¼šè¶‹å‘äº0ã€‚

**2. He initialization**

ä¸ºäº†è§£å†³ä¸Šé¢çš„é—®é¢˜ï¼Œä½•æºæ˜å¤§ç¥æå‡ºäº†ä¸€ç§é’ˆå¯¹ReLUçš„åˆå§‹åŒ–æ–¹æ³•ï¼Œä¸€èˆ¬ç§°ä½œ He initializationã€‚åˆå§‹åŒ–ä»£ç ä¸ºï¼š

```python
tf.Variable(np.random.randn(node_in,node_out))/np.sqrt(node_in/2)
```

ç»è¿‡He initializationåï¼Œå½“éšè—å±‚ä½¿ç”¨ReLUæ—¶ï¼Œæ¿€æ´»å‡½æ•°çš„è¾“å‡ºå€¼çš„åˆ†å¸ƒæƒ…å†µï¼š

![](https://upload-images.jianshu.io/upload_images/24408463-042b50c2ba6a8528.png?imageMogr2/auto-orient/strip|imageView2/2/format/webp)

æ•ˆæœæ˜¯æ¯”Xavier initializationå¥½å¾ˆå¤šã€‚**ç°åœ¨ç¥ç»ç½‘ç»œä¸­ï¼Œéšè—å±‚å¸¸ä½¿ç”¨ReLUï¼Œæƒé‡åˆå§‹åŒ–å¸¸ç”¨He initializationæ–¹æ³•ã€‚**

> å‚è€ƒæ–‡çŒ®ï¼šhttps://blog.csdn.net/u012328159/article/details/80025785?utm_medium=distribute.pc_relevant.none-task-blog-title-1&spm=1001.2101.3001.4242

#### 3.9.4 PBTç®—æ³•ï¼ˆPopulation Based Trainingï¼ŒåŸºäºç¾¤ä½“çš„è®­ç»ƒï¼‰

ç¥ç»ç½‘ç»œåœ¨æŸä¸ªç‰¹å®šåº”ç”¨ä¸­çš„æˆåŠŸé€šå¸¸å–å†³äºåœ¨ç ”ç©¶åˆå§‹æ—¶æ‰€åšçš„ä¸€ç³»åˆ—é€‰æ‹©ï¼ŒåŒ…æ‹¬é€‰æ‹©è¦ä½¿ç”¨çš„ç½‘ç»œç±»å‹ä»¥åŠç”¨äºè®­ç»ƒçš„æ•°æ®å’Œæ–¹æ³•ã€‚ç›®å‰ï¼Œè¿™äº›é€‰æ‹©ï¼ˆè¢«ç§°ä½œè¶…å‚æ•°ï¼‰æ˜¯é€šè¿‡ç»éªŒã€éšæœºæœç´¢æˆ–è®¡ç®—å¯†é›†å‹çš„æœç´¢è¿‡ç¨‹æ¥å®ç°çš„ã€‚

DeepMindåœ¨æœ€æ–°çš„ä¸€ç¯‡è®ºæ–‡ *Population Based Training of Neural Networks* ä¸­ï¼Œæå‡ºäº†ä¸€ç§æ–°çš„è®­ç»ƒç¥ç»ç½‘ç»œçš„æ–¹æ³•PBTï¼Œè¿™æ˜¯ä¸€ç§å¼‚æ­¥ä¼˜åŒ–ç®—æ³•ï¼Œå®ƒåŒæ—¶è®­ç»ƒå’Œä¼˜åŒ–ä¸€ä¸ªç¾¤ä½“çš„ç½‘ç»œï¼Œä»è€Œå¿«é€Ÿåœ°ä¸ºä»»åŠ¡é€‰æ‹©æœ€ä½³çš„è¶…å‚æ•°é›†åˆå’Œæ¨¡å‹ã€‚æœ€é‡è¦çš„æ˜¯ï¼Œè¿™ç§æ–¹æ³•ä¸ä¼šå¢åŠ è®¡ç®—å¼€é”€ï¼Œèƒ½å¤Ÿæœ€å¤§é™åº¦åœ°æé«˜æ€§èƒ½ï¼Œå¹¶ä¸”å¾ˆå®¹æ˜“é›†æˆåˆ°ç°æœ‰çš„æœºå™¨å­¦ä¹ æµç¨‹ä¸­ã€‚DeepMindè®¤ä¸ºè¿™ä¸€æ–¹æ³•æœ‰å¾ˆå¤§æ½œåŠ›ã€‚

PBTæŠ€æœ¯æ˜¯ä¸¤ç§æœ€å¸¸ç”¨çš„è¶…å‚æ•°ä¼˜åŒ–æ–¹æ³•çš„ç»“åˆï¼š**éšæœºæœç´¢**å’Œ**æ‰‹åŠ¨è°ƒä¼˜**ã€‚

åœ¨éšæœºæœç´¢ä¸­ï¼Œç¥ç»ç½‘ç»œç¾¤ä½“(population) è¢«å¹¶è¡Œåœ°ç‹¬ç«‹è®­ç»ƒï¼Œåœ¨è®­ç»ƒç»“æŸæ—¶ï¼Œé€‰æ‹©æ€§èƒ½æœ€ä¼˜çš„æ¨¡å‹ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œè¿™æ„å‘³ç€åªæœ‰ç¾¤ä½“çš„ä¸€å°éƒ¨åˆ†ä¼šå¾—åˆ°è‰¯å¥½çš„è¶…å‚æ•°è®­ç»ƒï¼Œæ›´å¤šçš„éƒ¨åˆ†å¾—åˆ°ä¸å¥½çš„è¶…å‚æ•°è®­ç»ƒï¼Œæµªè´¹è®¡ç®—èµ„æºã€‚

![](https://upload-images.jianshu.io/upload_images/24408463-fac1cb46b2ac188a.png?imageMogr2/auto-orient/strip|imageView2/2/format/webp)



é€šè¿‡æ‰‹åŠ¨è°ƒä¼˜ï¼Œç ”ç©¶äººå‘˜å¿…é¡»çŒœæµ‹å“ªäº›æ˜¯æœ€å¥½çš„è¶…å‚æ•°ï¼Œä½¿ç”¨å®ƒä»¬æ¥è®­ç»ƒæ¨¡å‹ï¼Œç„¶åå¯¹æ€§èƒ½è¿›è¡Œè¯„ä¼°ã€‚è¿™ä¸ªè¿‡ç¨‹ä¸€ééåœ°é‡å¤ï¼Œç›´åˆ°ç ”ç©¶äººå‘˜å¯¹ç½‘ç»œçš„æ€§èƒ½æ„Ÿåˆ°æ»¡æ„ä¸ºæ­¢ã€‚å°½ç®¡è¿™å¯èƒ½ä¼šå¸¦æ¥æ›´å¥½çš„æ€§èƒ½ï¼Œä½†ç¼ºç‚¹æ˜¯éœ€è¦å¾ˆé•¿æ—¶é—´ï¼Œæœ‰æ—¶éœ€è¦å‡ å‘¨ç”šè‡³å‡ ä¸ªæœˆæ‰èƒ½æ‰¾åˆ°å®Œç¾çš„è®¾ç½®ã€‚è™½ç„¶æœ‰ä¸€äº›æ–¹æ³•å¯ä»¥è‡ªåŠ¨åŒ–è¿™ä¸ªè¿‡ç¨‹ï¼Œä¾‹å¦‚è´å¶æ–¯ä¼˜åŒ–ï¼Œä½†æ˜¯ä»ç„¶éœ€è¦å¾ˆé•¿çš„æ—¶é—´ï¼Œå¹¶ä¸”éœ€è¦å¤§é‡çš„è¿ç»­è®­ç»ƒæ‰èƒ½æ‰¾åˆ°æœ€å¥½çš„è¶…å‚æ•°ã€‚

![](https://upload-images.jianshu.io/upload_images/24408463-d2c3dcae339de693.png?imageMogr2/auto-orient/strip|imageView2/2/format/webp)



PBTï¼Œå°±åƒéšæœºæœç´¢ï¼Œä¸€å¼€å§‹æ˜¯ä»¥éšæœºçš„è¶…å‚æ•°å¹¶è¡Œåœ°è®­ç»ƒè®¸å¤šç¥ç»ç½‘ç»œã€‚ä½†æ˜¯ï¼Œè¿™äº›ç½‘ç»œä¸æ˜¯ç‹¬ç«‹çš„ï¼Œè€Œæ˜¯ä½¿ç”¨æ¥è‡ªç¾¤ä½“ï¼ˆpopulationï¼‰ä¸­å…¶ä½™éƒ¨åˆ†çš„ä¿¡æ¯æ¥è°ƒä¼˜è¶…å‚æ•°ï¼Œå¹¶ä¸”å°†è®¡ç®—èµ„æºå¼•å¯¼åˆ°æœ‰å¸Œæœ›çš„æ¨¡å‹ã€‚è¿™æ˜¯ä»é—ä¼ ç®—æ³•ä¸­è·å¾—å¯å‘çš„ï¼Œåœ¨é—ä¼ ç®—æ³•ä¸­ï¼Œpopulationä¸­çš„æ¯ä¸ªæˆå‘˜ï¼ˆè¢«ç§°ä¸ºworkerï¼‰éƒ½å¯ä»¥åˆ©ç”¨å…¶ä»–æˆå‘˜çš„ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªworkerå¯ä»¥ä»ä¸€ä¸ªæ€§èƒ½æ›´å¥½çš„workerä¸­æ‹·è´æ¨¡å‹å‚æ•°ï¼Œä¹Ÿå¯ä»¥é€šè¿‡éšæœºæ”¹å˜å½“å‰çš„å€¼æ¥æ¢ç´¢æ–°çš„è¶…å‚æ•°ã€‚

éšç€ç¥ç»ç½‘ç»œpopulationçš„è®­ç»ƒç»§ç»­è¿›è¡Œï¼Œè¿™ç§å¼€å‘å’Œæ¢ç´¢çš„è¿‡ç¨‹ä¹Ÿå‘¨æœŸæ€§åœ°è¿›è¡Œï¼Œç¡®ä¿populationä¸­æ‰€æœ‰çš„workeréƒ½æœ‰ä¸€ä¸ªè‰¯å¥½çš„åŸºç¡€æ€§èƒ½æ°´å¹³ï¼Œå¹¶ä¸”ä¸€ç›´ä¸æ–­åœ°æ¢ç´¢æ–°çš„è¶…å‚æ•°ã€‚è¿™æ„å‘³ç€PBTå¯ä»¥å¿«é€Ÿåˆ©ç”¨è‰¯å¥½çš„è¶…å‚æ•°ï¼Œå¯ä»¥å°†æ›´å¤šè®­ç»ƒæ—¶é—´åˆ†é…ç»™æœ‰å¸Œæœ›çš„æ¨¡å‹ï¼Œå¹¶ä¸”ï¼Œå…³é”®çš„æ˜¯ï¼Œå¯ä»¥åœ¨æ•´ä¸ªè®­ç»ƒè¿‡ç¨‹ä¸­è°ƒæ•´è¶…å‚æ•°å€¼ï¼Œä»è€Œè‡ªåŠ¨å­¦ä¹ æœ€ä½³é…ç½®ã€‚

![](https://upload-images.jianshu.io/upload_images/24408463-e72d1488633f19ae.png?imageMogr2/auto-orient/strip|imageView2/2/format/webp)

å®éªŒè¡¨æ˜ï¼ŒPBTåœ¨ä¼—å¤šä»»åŠ¡å’Œé¢†åŸŸéƒ½éå¸¸æœ‰æ•ˆã€‚DeepMindè®¤ä¸ºï¼Œè¿™é¡¹æŠ€æœ¯æ½œåŠ›å¾ˆå¤§ã€‚ä»–ä»¬è¿˜å‘ç°PBTå¯¹äºè®­ç»ƒ**å¼•å…¥æ–°çš„è¶…å‚æ•°çš„æ–°ç®—æ³•å’Œç¥ç»ç½‘ç»œæ¶æ„**ç‰¹åˆ«æœ‰ç”¨ã€‚éšç€è¿™ä¸ªè¿‡ç¨‹çš„ä¸æ–­æ”¹è¿›ï¼ŒPBTæœ‰æœ›å¯»æ‰¾å’Œå¼€å‘æ›´å¤æ‚ã€æ›´å¼ºå¤§çš„ç¥ç»ç½‘ç»œæ¨¡å‹ã€‚

> å‚è€ƒæ–‡çŒ®ï¼šhttps://www.sohu.com/a/207107606_473283

### 3.10 å¦‚ä½•ç”¨ç¥ç»ç½‘ç»œå®ç°XORåˆ†ç±»

**ä»€ä¹ˆæ˜¯å¼‚æˆ–(XOR)ï¼š**
åœ¨æ•°å­—é€»è¾‘ä¸­ï¼Œå¼‚æˆ–æ˜¯å¯¹ä¸¤ä¸ªè¿ç®—å…ƒçš„ä¸€ç§é€»è¾‘åˆ†æç±»å‹ï¼Œç¬¦å·ä¸ºXORæˆ–EORæˆ–âŠ•ã€‚å½“ä¸¤ä¸¤æ•°å€¼ç›¸åŒæ—¶ä¸ºå¦ï¼Œè€Œæ•°å€¼ä¸åŒæ—¶ä¸ºçœŸã€‚å¼‚æˆ–çš„çœŸå€¼è¡¨å¦‚ä¸‹ï¼š
![](https://p0.ssl.img.360kuai.com/t016e9cf3413274f359.webp)
**å¦‚ä½•ç”¨ç¥ç»ç½‘ç»œå®ç°å¼‚æˆ–(XOR)ï¼š**
ç¥ç»ç½‘ç»œåº”ç”¨åœ¨åˆ†ç±»é—®é¢˜ä¸­æ•ˆæœå¾ˆå¥½ï¼Œé€»è¾‘å›å½’å¯ä»¥é€šè¿‡**æ”¹å˜å‚æ•°**æ¥å®ç°â€œä¸â€ã€â€œæˆ–â€ã€â€œéâ€ç­‰ç®€å•æ“ä½œã€‚
åœ¨å´æ©è¾¾è€å¸ˆçš„ã€æœºå™¨å­¦ä¹ ã€‘è¯¾ç¨‹ç¬¬68ã€70è¯¾æ—¶ä¸­ï¼Œä½¿ç”¨äº†AND(ä¸)ã€NOR(æˆ–é)å’ŒOR(æˆ–)çš„ç»„åˆå®ç°äº†XNOR(åŒæˆ–)ï¼Œç”±äºç”¨ç¥ç»ç½‘ç»œå®ç°å¼‚æˆ–(XOR)ä¸åŒæˆ–(XNOR)çš„è¿‡ç¨‹æ˜¯ç›¸åŒçš„åªæ˜¯è¾“å‡ºç»“æœäº’ä¸ºç›¸åæ•°ï¼Œæ•…åœ¨æ­¤è®¨è®ºç”¨ç¥ç»ç½‘ç»œå®ç°XNOR(åŒæˆ–)çš„å…·ä½“è¿‡ç¨‹ï¼š

1. ANDè¿ç®—ç¥ç»ç½‘ç»œ
![](http://m.qpic.cn/psc?/V50v5bPV1er4BO1DcJVb3iyeFd3aL3dx/ruAMsa53pVQWN7FLK88i5rr5ZGbvHqAI1WYfIvA4DI1pYEgfvobysuD8rUI72542oT3oJnRb*HC9OZkABHupkvl35xh44XG8G2ACXjqIsHA!/b&bo=AgGLAAIBiwADCSw!&rf=viewer_4)
æ¨¡å‹å‡½æ•°å¦‚ä¸‹ï¼š
$$h_{\theta}(x)=g\left(-30+20 x_{1}+20 x_{2}\right)=\frac{1}{1+e^{-(-30+20 x_{1}+20 x_{2})}}$$
ç»“æœï¼š
![](http://m.qpic.cn/psc?/V50v5bPV1er4BO1DcJVb3iyeFd3aL3dx/45NBuzDIW489QBoVep5mcYiNBcz7No1IR.Drf6fnOs1vWtDIV.K05p50.fXdEN7av*d7HGoxmtNdwDBAoj.k0NvkTDwe3S8J5XXA6Ul2ycg!/b&bo=KQEhASkBIQEDGTw!&rf=viewer_4)
2. NOR(æˆ–é)è¿ç®—ç¥ç»ç½‘ç»œ
![](http://m.qpic.cn/psc?/V50v5bPV1er4BO1DcJVb3iyeFd3aL3dx/45NBuzDIW489QBoVep5mcVqsKjONzu7mjtQrIpU3RbgoSvkv44FXSToJ8SM..0ZY7*5qY0MePsXbF6VRkzVcamaahE1OXfF.fKs3Rnjug8w!/b&bo=tQBoALUAaAADGTw!&rf=viewer_4)
æ¨¡å‹å‡½æ•°å¦‚ä¸‹ï¼š
$$h_{\theta}(x)=g\left(-10-20 x_{1}-20 x_{2}\right)=\frac{1}{1+e^{-(-10-20 x_{1}-20 x_{2})}}$$
ç»“æœï¼š
![](http://m.qpic.cn/psc?/V50v5bPV1er4BO1DcJVb3iyeFd3aL3dx/45NBuzDIW489QBoVep5mcVqsKjONzu7mjtQrIpU3Rbj.8JS7uBKTyX6zPflrK3t51TZK4G5rzx6rFv4oY3eHFeWCjenvQcpGpldmK50*R0A!/b&bo=2wHFANsBxQADGTw!&rf=viewer_4)
3. ORè¿ç®—ç¥ç»ç½‘ç»œ
![](http://m.qpic.cn/psc?/V50v5bPV1er4BO1DcJVb3iyeFd3aL3dx/45NBuzDIW489QBoVep5mcVqsKjONzu7mjtQrIpU3RbhuhKzyCNPNpAg6rV9sby1qc.VbzbOKk3DIOf5IHjbiyAnT7B9RYRUYWOKJc3rRINw!/b&bo=9ACLAPQAiwADGTw!&rf=viewer_4)
æ¨¡å‹å‡½æ•°å¦‚ä¸‹ï¼š
$$h_{\theta}(x)=g\left(-10+20 x_{1}+20 x_{2}\right)=\frac{1}{1+e^{-(-10+20 x_{1}+20 x_{2})}}$$
ç»“æœï¼š
![](http://m.qpic.cn/psc?/V50v5bPV1er4BO1DcJVb3iyeFd3aL3dx/45NBuzDIW489QBoVep5mcVqsKjONzu7mjtQrIpU3RbgQ4l.G1orM5Rq7uuaYlc*frToz2g4hjiWbCQYHXqfiyyOMR3NCo99*Ci6WW0WVFkQ!/b&bo=2AG*ANgBvwADGTw!&rf=viewer_4)
4ã€æ„å»ºXNORç½‘ç»œ(å¼‚æˆ–)ï¼š
$$A \odot B=A B+\overline{A B}=A B+\overline{A+B}$$
æ•…å¯åœ¨è¾“å…¥å±‚è¾“å…¥ç‰¹å¾å€¼Aï¼ˆ$a_1^{(1)}$ï¼‰å’ŒBï¼ˆ$a_2^{(1)}$ï¼‰ï¼Œå¹¶å‡è®¾$a_0^{(1)}=1$ï¼Œä¸‰è€…åŒæ—¶è¾“å…¥éšè—å±‚ç¬¬ä¸€ä¸ªç¥ç»å…ƒå®ç°Aå’ŒBçš„ä¸è¿ç®—å¾—åˆ°$a_1^{(2)}$ï¼ŒåŒæ—¶è¾“å…¥éšè—å±‚ç¬¬äºŒä¸ªç¥ç»å…ƒå®ç°Aå’ŒBçš„æˆ–éè¿ç®—å¾—åˆ°$a_2^{(2)}$ï¼Œåœ¨éšè—å±‚å‡è®¾$a_0^{(2)}=1$ï¼Œä¸‰è€…åŒæ—¶è¾“å…¥è¾“å‡ºå±‚ç¥ç»å•å…ƒå®ç°æˆ–è¿ç®—å¾—åˆ°$a_1^{(3)}$ï¼Œå³ç¥ç»ç½‘ç»œå®ç°åŒæˆ–è¿ç®—çš„æœ€ç»ˆè¾“å‡ºç»“æœ$h_{\theta}(x)$ã€‚å…·ä½“ç¥ç»ç½‘ç»œç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š
![](http://m.qpic.cn/psc?/V50v5bPV1er4BO1DcJVb3iyeFd3aL3dx/45NBuzDIW489QBoVep5mce5is5SjellblXQNkx859nYgVkKvVrckRF77OGAIcQS3FllFEcSPuf0jesfZWjJwl1lIvUv8XOTs1pjq26QdAOE!/b&bo=SARMAkgETAIDGTw!&rf=viewer_4)
è¿ç®—ç»“æœå¦‚ä¸‹ï¼š
![](http://m.qpic.cn/psc?/V50v5bPV1er4BO1DcJVb3iyeFd3aL3dx/45NBuzDIW489QBoVep5mce5is5SjellblXQNkx859na.LKI*vKzkMpkhfXIkSWz*2DRQe92cumPAgWbmFiGkoC07iWcDGPGuyDziN5Q4EHs!/b&bo=OgG.ADoBvgADGTw!&rf=viewer_4)
åœ¨åŒæˆ–ç¥ç»ç½‘ç»œåå†åŠ å…¥å®ç°â€œéâ€è¿ç®—çš„ç¥ç»å…ƒï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå³å¯å®ç°å¼‚æˆ–è¿ç®—ã€‚
![](http://m.qpic.cn/psc?/V50v5bPV1er4BO1DcJVb3iyeFd3aL3dx/45NBuzDIW489QBoVep5mce5is5SjellblXQNkx859nZyqSp5GVCoN64JCkhe5UFVWTYG4izLVPUbgG09Tu0Vf3mZRD6gTNjSNu.FrQZN3Bo!/b&bo=EQKlABECpQADGTw!&rf=viewer_4)



ä¸‹é¢é‡‡ç”¨æ¿€æ´»å‡½æ•°ä¸ºtanh(x)çš„ä¸‰å±‚ç½‘ç»œæ¥è§£å†³å¼‚æˆ–é—®é¢˜(å½“æ¿€æ´»å‡½æ•°ä¸ºå¥‡å‡½æ•°æ—¶ï¼ŒBP ç®—æ³•çš„å­¦ä¹ é€Ÿåº¦è¦å¿«ä¸€äº›ï¼Œæœ€å¸¸ç”¨çš„å¥‡å‡½æ•°æ˜¯åŒæ›²æ­£åˆ‡å‡½æ•°)ã€‚

**ä»£ç å®ç°ï¼š**

```python
import numpy as np

# åŒæ›²æ­£åˆ‡å‡½æ•°,è¯¥å‡½æ•°ä¸ºå¥‡å‡½æ•°
def tanh(x):    
    return np.tanh(x)

# tanhå¯¼å‡½æ•°æ€§è´¨:f'(t) = 1 - f(x)^2
def tanh_prime(x):      
    return 1.0 - tanh(x)**2

# æ„å»ºç¥ç»ç½‘ç»œ
class NeuralNetwork:
    def __init__(self, layers, activation = 'tanh'):
        """
        :å‚æ•°layers: ç¥ç»ç½‘ç»œçš„ç»“æ„(è¾“å…¥å±‚-éšå«å±‚-è¾“å‡ºå±‚åŒ…å«çš„ç»“ç‚¹æ•°åˆ—è¡¨)
        :å‚æ•°activation: æ¿€æ´»å‡½æ•°ç±»å‹
        """
        if activation == 'tanh':    # ä¹Ÿå¯ä»¥ç”¨å…¶å®ƒçš„æ¿€æ´»å‡½æ•°
            self.activation = tanh
            self.activation_prime = tanh_prime
        else:
            pass

        # å­˜å‚¨æƒå€¼çŸ©é˜µ
        self.weights = []

        # range of weight values (-1,1)
        # åˆå§‹åŒ–è¾“å…¥å±‚å’Œéšå«å±‚ä¹‹é—´çš„æƒå€¼
        for i in range(1, len(layers) - 1):
            r = 2*np.random.random((layers[i-1] + 1, layers[i] + 1)) -1     # add 1 for bias node
            self.weights.append(r)

        # åˆå§‹åŒ–è¾“å‡ºå±‚æƒå€¼
        r = 2*np.random.random( (layers[i] + 1, layers[i+1])) - 1
        self.weights.append(r)


    def fit(self, X, Y, learning_rate=0.2, epochs=10000):
        # Add column of ones to X
        # This is to add the bias unit to the input layer
        X = np.hstack([np.ones((X.shape[0],1)),X])


        for k in range(epochs):     # è®­ç»ƒå›ºå®šæ¬¡æ•°
            if k % 1000 == 0: print ('epochs:', k)

            # Return random integers from the discrete uniform distribution in the interval [0, low).
            i = np.random.randint(X.shape[0],high=None)
            a = [X[i]]   # ä»mä¸ªè¾“å…¥æ ·æœ¬ä¸­éšæœºé€‰ä¸€ç»„

            for l in range(len(self.weights)):
                    dot_value = np.dot(a[l], self.weights[l])   # æƒå€¼çŸ©é˜µä¸­æ¯ä¸€åˆ—ä»£è¡¨è¯¥å±‚ä¸­çš„ä¸€ä¸ªç»“ç‚¹ä¸ä¸Šä¸€å±‚æ‰€æœ‰ç»“ç‚¹ä¹‹é—´çš„æƒå€¼
                    activation = self.activation(dot_value)
                    a.append(activation)

            # åå‘é€’æ¨è®¡ç®—delta:ä»è¾“å‡ºå±‚å¼€å§‹,å…ˆç®—å‡ºè¯¥å±‚çš„delta,å†å‘å‰è®¡ç®—
            error = Y[i] - a[-1]    # è®¡ç®—è¾“å‡ºå±‚delta
            deltas = [error * self.activation_prime(a[-1])]

            # ä»å€’æ•°ç¬¬2å±‚å¼€å§‹åå‘è®¡ç®—delta
            for l in range(len(a) - 2, 0, -1):
                deltas.append(deltas[-1].dot(self.weights[l].T)*self.activation_prime(a[l]))


            # [level3(output)->level2(hidden)]  => [level2(hidden)->level3(output)]
            deltas.reverse()    # é€†è½¬åˆ—è¡¨ä¸­çš„å…ƒç´ 


            # backpropagation
            # 1. Multiply its output delta and input activation to get the gradient of the weight.
            # 2. Subtract a ratio (percentage) of the gradient from the weight.
            for i in range(len(self.weights)):  # é€å±‚è°ƒæ•´æƒå€¼
                layer = np.atleast_2d(a[i])     # View inputs as arrays with at least two dimensions
                delta = np.atleast_2d(deltas[i])
                self.weights[i] += learning_rate * np.dot(layer.T, delta) # æ¯è¾“å…¥ä¸€æ¬¡æ ·æœ¬,å°±æ›´æ–°ä¸€æ¬¡æƒå€¼

    def predict(self, x):
        a = np.concatenate((np.ones(1), np.array(x)))       # aä¸ºè¾“å…¥å‘é‡(è¡Œå‘é‡)
        for l in range(0, len(self.weights)):               # é€å±‚è®¡ç®—è¾“å‡º
            a = self.activation(np.dot(a, self.weights[l]))
        return a
    
    
if __name__ == '__main__':
    nn = NeuralNetwork([2,2,1])     # ç½‘ç»œç»“æ„: 2è¾“å…¥1è¾“å‡º,1ä¸ªéšå«å±‚(åŒ…å«2ä¸ªç»“ç‚¹)

    X = np.array([[0, 0],           # è¾“å…¥çŸ©é˜µ(æ¯è¡Œä»£è¡¨ä¸€ä¸ªæ ·æœ¬,æ¯åˆ—ä»£è¡¨ä¸€ä¸ªç‰¹å¾)
                  [0, 1],
                  [1, 0],
                  [1, 1]])
    Y = np.array([0, 1, 1, 0])      # æœŸæœ›è¾“å‡º

    nn.fit(X, Y)                    # è®­ç»ƒç½‘ç»œ

    print ('w:', nn.weights)          # è°ƒæ•´åçš„æƒå€¼åˆ—è¡¨

    for s in X:
        print(s, nn.predict(s))     # æµ‹è¯•
```

æµ‹è¯•ç»“æœï¼š

![](https://upload-images.jianshu.io/upload_images/24408463-67602774564737de.png?imageMogr2/auto-orient/strip|imageView2/2/format/webp)



- 
